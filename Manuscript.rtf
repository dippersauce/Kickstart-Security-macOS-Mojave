{\rtf1\ansi\ansicpg1252\cocoartf1561\cocoasubrtf600
{\fonttbl\f0\fnil\fcharset0 Futura-Bold;\f1\fnil\fcharset0 Futura-Medium;\f2\fnil\fcharset0 IowanOldStyle-Roman;
\f3\fnil\fcharset0 IowanOldStyle-Italic;\f4\fswiss\fcharset0 Helvetica;\f5\fnil\fcharset0 Menlo-Regular;
\f6\fnil\fcharset0 HelveticaNeue;\f7\fmodern\fcharset0 Courier;}
{\colortbl;\red255\green255\blue255;\red255\green255\blue255;\red0\green0\blue0;\red255\green255\blue255;
\red255\green255\blue255;\red50\green76\blue126;\red255\green255\blue255;\red12\green96\blue172;\red0\green0\blue0;
\red235\green235\blue235;\red255\green255\blue255;\red36\green38\blue41;\red235\green236\blue237;}
{\*\expandedcolortbl;;\cssrgb\c100000\c100000\c100000;\cssrgb\c0\c0\c0;\cssrgb\c99994\c100000\c99988;
\cssrgb\c99991\c100000\c99988;\cssrgb\c25098\c37647\c56863;\cssrgb\c99991\c100000\c99988;\cssrgb\c0\c46104\c73102;\csgray\c0\c0;
\cssrgb\c93594\c93608\c93591;\cssrgb\c100000\c100000\c100000;\cssrgb\c18824\c20000\c21176;\cssrgb\c93725\c94118\c94510;}
\paperw15364\paperh20476\margl1080\margr1080\margb1080\margt1080
\deftab720
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs66 \cf2 \kerning1\expnd26\expndtw132
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec2    \page \pard\tqr\tx13204\pardeftab720\sl360\slmult1\partightenfactor0

\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 \
Chapter One: macOS Fundamentals	5\
\pard\tqr\tx13204\pardeftab720\li360\sa120\partightenfactor0

\f1\b0 \cf3 \strokec3 The Big Picture: Darwin	5\
What Composes Darwin	6\
The XNU Kernel	7\
The Mach Microkernel	7\
I/O Kit	8\
The BSD Components	8\
The Command Line Utilities	16\
Binaries and App Bundles	44\
\pard\tqr\tx13204\pardeftab720\sl360\slmult1\partightenfactor0

\f0\b \cf3 \strokec3 Chapter Two: Secure Accounts and Groups	45\
\pard\tqr\tx13204\pardeftab720\li360\sa120\partightenfactor0

\f1\b0 \cf3 \strokec3 Users	45\
Groups	45\
User Account Types	47\
GUI Account Management	53\
CLI Account Management	56\
GUI Group Management	68\
CLI Group Management	71\
Additional Methods to Secure Accounts	76\
UNIX File Permissions	78\
Editing File Permissions From The CLI	85\
Editing File Permissions From The GUI	89\
\pard\tqr\tx13204\pardeftab720\sl360\slmult1\partightenfactor0

\f0\b \cf3 \strokec3 Chapter Three: Secure Base Images and Deployment	90\
\pard\tqr\tx13204\pardeftab720\li360\sa120\partightenfactor0

\f1\b0 \cf3 \strokec3 Create External Installation Media	90\
Internet Recovery	94\
Mass Image Deployment and Mobile Device Management	96\
\pard\tqr\tx13204\pardeftab720\sl360\slmult1\partightenfactor0

\f0\b \cf3 \strokec3 Chapter Four: Securing The Base System	98\
\pard\tqr\tx13204\pardeftab720\li360\sa120\partightenfactor0

\f1\b0 \cf3 \strokec3 A Note About Device Profiles and Policies	98\
Secure System Services	98\
Quick Look	99\
Spotlight Suggestions	103\
Siri	109\
iCloud	110\
Data Encryption	112\
Removable Devices	119\
Understanding System Security Services	121\
System Updates	137\
Combating Malware	143\
Vulnerability Awareness	145\
\pard\tqr\tx13204\pardeftab720\sl360\slmult1\partightenfactor0

\f0\b \cf3 \strokec3 Chapter Five: Securing User Facing  Apps and Software	146\
\pard\tqr\tx13204\pardeftab720\li360\sa120\partightenfactor0

\f1\b0 \cf3 \strokec3 App Code Security	146\
Safari	152\
Apple Mail	157\
\pard\tqr\tx13204\pardeftab720\sl360\slmult1\partightenfactor0

\f0\b \cf3 \strokec3 Chapter Six: Putting It All Together	159\
\pard\tqr\tx13204\pardeftab720\li360\sa120\partightenfactor0

\f1\b0 \cf3 \strokec3 License Information For This Publication	160\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2 \cf3 \strokec3 \page \pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
 \
\
\
\
\
\
\
\
\pard\pardeftab720\sl264\slmult1\sa320\qc\partightenfactor0

\f2\b0\fs40 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Caught in a never-ending game\'85\
Seems like the world\'92s\
still trying to tame us.\
If that\'92s the way, we will obey.\
Beautifully struggle every day.\
-\
Thank you for everything.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
Chapter One: macOS Fundamentals \
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 To properly defend a system, it is necessary to possess at least a basic understanding of how it works. We will assume you are familiar with Aqua (the GUI interface), but perhaps are not as well versed with macOS's architecture or UNIX characteristics. If you are familiar with these however, you may safely skip this chapter.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 The Big Picture: Darwin\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 A logical place to begin our understanding of macOS is Darwin, the "core" of macOS. Darwin forms the basis upon which all of Apple's current operating systems are built. Each operating system uses a customized version of Darwin that's been tuned to meet the needs of the device that runs it. In this regard macOS is simply a version of Darwin modified to meet the needs of modern Mac computers.\
\pard\pardeftab720\sa500\qc\partightenfactor0

\f1\fs20 \cf3 \strokec3  \
\pard\pardeftab720\sa500\qc\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://www.maxpixel.net/Smartphone-Laptop-Macbook-Pro-Apple-Desk-Office-1282241"}}{\fldrslt \cf3 \ul \ulc3 \strokec3 https://www.maxpixel.net/Smartphone-Laptop-Macbook-Pro-Apple-Desk-Office-1282241}}, Creative Commons Zero - CC0\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 What Composes Darwin\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Darwin can be roughly divided into collections of APIs, utilities, and kernel code. Each plays a role in the system as a whole, and many parts are dependent on each other to function. \
The APIs sit atop the services and the Darwin core, providing a simple and consistent means of developing software. Darwin provides the methods to interact with and control the underlying XNU kernel, while the kernel provides the hardware abstraction required for the above layers to run. XNU itself can also be further divided based on the purpose and origin of its components. \
\pard\pardeftab720\sa500\qc\partightenfactor0

\f1\fs20 \cf3 \strokec3 Utente:Sassospicco [CC BY-SA 2.5 (https://creativecommons.org/licenses/by-sa/2.5), GFDL (http://www.gnu.org/copyleft/fdl.html) or CC-BY-SA-3.0 (http://creativecommons.org/licenses/by-sa/3.0/)], via Wikimedia Commons\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 The XNU Kernel\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The XNU kernel is a hybrid kernel combining the Mach microkernel, FreeBSD components, and a C++ driver API called I/O Kit. This modular design is intended to leverage the best features of multiple operating system designs, while limiting the downsides associated with them. Although the boundaries between the different parts of the kernel are well-defined, they work together seamlessly to form a single, cohesive design. \
\
\pard\pardeftab720\sa500\qc\partightenfactor0

\f1\fs20 \cf3 \strokec3 Robryecran77 [CC BY-SA 4.0 (https://creativecommons.org/licenses/by-sa/4.0)], from Wikimedia Commons\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 The Mach Microkernel\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Mach was originally conceived in 1985, as a replacement kernel for the then-popular UNIX operating system. Although it failed to gain widespread popularity, its extreme extensibility and simple design set the stage for its future success at Apple. The version of Mach shipped with Darwin is based on OSFMK, and represents a significant evolution in terms of capabilities. Mach boasts advanced scheduling operations, IPC, memory management, and even the inclusion of BSD components.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 I/O Kit\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 I/O Kit is a framework within XNU that provides access to special objects for developing hardware device drivers. IOKit drivers declare a "base" and "nub" classes to assist the kernel in deciding whether a particular IOKit driver is appropriate for a particular device. This encourages drivers to be designed as modularly as possible to encourage driver inheritance, which reduces code duplication and complexity. Access to I/O Kit objects is managed by the kernel, but does not implement direct access to the kernel itself. For code that must access portions of the kernel, a kernel extension is required.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 The BSD Components\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The second (and arguably most visible) part of XNU is the BSD Components, a collection of FreeBSD-derived code that provides XNU with its UNIX "personality". Although the BSD kernel code exists alongside Mach, all of the BSD abstractions map directly onto Mach at some point. The BSD code provides a significant chunk of the user space implementation, including the process and daemon model, network operations, filesystem abstraction, POSIX APIs, and many security related concepts such as user and group permissions. \
Given the berth of functionality provided by the BSD components, it is appropriate to cover them directly.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Processes\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Processes are the name given to instances of execution created by the BSD portions of the kernel. Although they are true UNIX processes, they are implemented by direct mapping to Mach execution primitives called Tasks. For the purposes of the security concepts covered in this book, you may think of processes on XNU as identical to standard BSD processes. Processes may also run in the background, in which case they are called Daemons. \
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Daemons\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Daemons are a traditional UNIX concept describing processes that run in the background. Daemons are not typically meant to display information directly to the GUI, but may feed data to a program that does. This is because some daemons run even if a user in not logged in, which would result in there being no GUI to display to. Daemons on Darwin come in two kinds: LaunchAgents, and LaunchDaemons. Both are initialized and controlled by the launchd program.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
The Init Daemon, launchd\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 In UNIX-like systems, the init daemon is the first process started by the kernel after boot. As the first process, it is assigned process ID (PID) 1, and is responsible for for loading and maintaining all other processes. In macOS the init daemon is called \'93launchd\'94. launchd uses scripts located in /etc/rc to scan the designated directories for LaunchAgents and LaunchDaemons to spawn, and calls launchctl to parse the property lists for any it finds. Property list (.plist) files define the configuration and condition of daemons to be launched by launchd.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 LaunchDaemons\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 LaunchDaemons are initialized at boot, and run with the privileges of the root user. LaunchDaemons are stored in one of two locations depending on who created it, and its intended purpose.\
1. /System/Libary/LaunchDaemons/ - (For system use only)\
2. /Library/LaunchDaemons/ - (For third-party daemons)\
LaunchDaemons cannot display information to the GUI due to the permissions with which they are spawned, so ensure that apps being ported or designed for macOS due not attempt to due this.\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 LaunchAgents\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Unlike LaunchDaemons, LaunchAgents do not run until a user has logged in. Property list files to trigger a LaunchAgent must be located in the following directories, based on who it is intended to run for:\
1. /Library/LaunchAgents/ - (Runs for all users)\
2. ~/Library/LaunchAgents/ - (Runs for a single user)\
3. /System/Library/LaunchAgents/ - (For system use only)\
Property list files for Daemons and Agents must be owned by root, in the wheel group, and permissions set to "0644". When creating these files, be sure to set the proper permissions as too liberal permissions could be hijacked by a malicious user or process. The user, group, and permission concepts referenced above are covered in greater detail in the next chapter. \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
The Shell\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 In UNIX parlance, a "shell" commonly refers to the interface wrapped around an operating system to allow the user to interact with it. Shells may take graphical forms like Aqua (macOS' GUI), or as command line interfaces like Bash or PowerShell. Darwin comes bundled with Bash, the "Bourne Again Shell". \
\
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Bash\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Bash is a flexible and extensible command processor that sees widespread usage on UNIX-like operating systems. Bash is an invaluable tool for navigating and manipulating the system, so special care will be taken to cover its capabilities and roles. \
Comparable to PowerShell as found on Windows, Bash interprets text-based inputs, and carries out operations based on those inputs. Bash can be automated using files called scripts, which contain a list of Bash commands. On macOS, Bash can be accessed by launching the Terminal app (from within the Utilities directory), or by booting into the special single user mode. \
Terminal starts an interactive Bash shell immediately after it is launched. The first line will display the last login, and the next line details the hostname, followed by the current user's name. The portions of Bash that accept typed input is directly to the right of the "$" symbol. \
\
The "$" symbol indicates that the current user is a normal user, not the "root" account. The significance of this may not be apparent now, but the roles and capabilities of the root account will be covered later.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Bash Keyboard Shortcuts\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Certain keyboard commands can be used within Bash to move the cursor, copy, paste, background or quit running commands. A brief list is provided below. Although the characters are in upper case, do not hold shift unless specified.\
Move cursor one character back: Ctrl+B (or left arrow)\
Move cursor one character forward: Ctrl+F (or right arrow)\
Delete current character (or close shell if no characters remain): Ctrl+D\
Delete all characters before cursor: Ctrl+U\
Go to beginning of current line: Ctrl+A\
Go to end of current line: Ctrl+E\
Suspend (kill) currently running command: Ctrl+C\
Stop (pause) currently running command: Ctrl+Z\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Bash Job Management\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Bash supports handing multiple commands at once by sending commands to the background and foreground using the "bg" and "fg" commands. Sending a command to the background using "bg" tells Bash not to wait for the command to complete, and instead return the user to an interactive prompt. The backgrounded command will continue to run, and any output will continue to appear in the current Bash shell. The command can then be brought back to the foreground (current shell) using the "fg" command.\
Before a command can be foregrounded, it must already be in the background. One method to send a command to the background is to append a space and the "&" symbol to the end of the command. This will immediately execute the command then move it to the background. \
\
\
\
The following example of the \'93&\'94 command uses the "top" command: \
\
The other method to stop a currently running command uses Bash's "Ctrl+Z" keyboard shortcut: \
\
The "jobs" command can then be used to see the stopped or background commands: \
\
The number in the brackets located to the far left indicates the command's job number. The "fg" and "bg" commands use this number as options to move the commands.  As commands are killed or spawned, the numbers will increment and decrement appropriately.\
\
\
\
\
\
\
\
\
The following example moves job number 2 to the foreground, then moves it to the background again using the Ctrl+Z shortcut: \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 The Command Line Utilities\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The Command Line Utilities is a collective term referring to the set of FreeBSD utilities shipped with macOS. These tools are similar in purpose to the GNU utilities found in most other operating systems, but with significant differences in behavior. To make the best use of the resources contained in this book, it is important to understand some of the most commonly used commands. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 The \'93man\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "man" command is used to display the manual pages for available utilities, commands, and certain other parts of the system. "Man" is short for "manual pages". To view a manual page for a particular item, use the name of the item as an option to the man command. To stop viewing a manual page, press the \'93q\'94 key.\
The following image demonstrates proper use of the the man command: \
\
\
\
Manual pages can also be searched for specific words or phrases. This is useful for discovering which pages have content relevant to a specific topic. To search for pages containing a keyword, supply the keyword after the "-k" option:  \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
The \'93ls\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "ls" command is primarily used list directory contents and file permissions. Its name is short for \'93list". If you simply wish to list the current directory's contents, execute "ls" without suppling any options. \
\
\
\
\
\
\
\
\
\
Paths can also be supplied \'93absolutely\'94 (ie. Explicitly), to see the contents of directories you are not currently in: \
\
To view the size, timestamp, and permissions of each item, supply the "-l" option: \
\
Files with names starting with a "." are hidden by UNIX convention. To view these "dotfiles" use the "-a" option.  \
\
ls has several more options available, but for the sake of brevity they are not covered. Additional options can be discovered by reading the manual pages, using the \'93man ls\'94 command. \
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 The \'93pwd\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The pwd command lists the current directory the shell is operating in. pwd does not accept options as it only performs this single action. List the current directory by simply executing \'93pwd": \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3  \
\
The \'93cd\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "cd" command changes the current directory. Directories can be an absolute path such as "/usr/bin/", or a relative path, referring to a directory within the current directory.\
To change to the "/System/Library" directory absolutely, use the full path as an option: \
\
\
\
\
\
\
\
\
\
To change to a directory contained within the current directory, use the relative path. If you were currently in the \'93/System/Library" directory, you could change to \'93Security/" by using it as an option: \
\
cd can also move up and down through directories by using two dots (..) as the option: \
\
A convenient shortcut to return to the current user's home directory is the \'93~\'94 option: \
\
To return to the default directory, just execute cd without any options: \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 The \'93mv\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "mv" command is used to move and rename files. mv accepts two options, the first being the source and the second being the destination. No distinction is made between files and directories as in the options, as both are treated the same by "mv". Just like "cd", paths can be relative or absolute.\
To move the "Grom.log" file into the "/tmp" directory, supply both as options in the appropriate order: \
\
\
\
\
\
\
\
To rename a file or directory, the current name is used as the first option, with the desired name used as the second:  \
\
Note that because of the ambiguity between files and directories, "mv" will interpret a move to a non-existent destination as a rename of original source to a new name consisting of the destination option. This may seem like an odd design choice, but traditional UNIX directories were technically just files that contained a list of other files and directories.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
\
\
\
\
\
The \'93nano\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 "nano" is an interactive command line text editor based on the venerable \'93UW Pico\'94. nano mimics much of Pico's design, but supersedes it in terms of functionality. \
Visually, nano consists of a single screen that occupies the entire terminal window. The top row shows the current version to the left, the current file in the middle, and modification status to the right. The bottom row shows available keyboard shortcuts. File contents appear in the middle and can be navigated using the terminal cursor: \
\
\
\
\
\
\
\
\
nano can be used to open a file by supplying the file's relative or absolute path as an option: \
\
If you would like to create a backup of the file being edited, use the "-B" option: \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
Nano Keyboard Shortcuts \
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Despite its simple design and small size, nano boasts a surprisingly large feature set. The most common keyboard shortcuts are listed below, but it is recommended that you read the man pages for complete coverage.\
Save File: Ctrl+O\
Cut Text: Ctrl+K\
Paste Text: Ctrl+U\
Select String: Ctrl+A (At beginning of string)\
Search: Ctrl+W\
Search and Replace: Ctrl+\\\
Exit Nano: Ctrl+X\
\
\
\
\
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 The \'93vim\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Vim is a command line editor like nano, but it takes a different approach to text editing. Vim makes use of modes, which determine how the editor reacts to keypresses. Two modes are available: \'93Command\'94 for entering Vim commands, and \'93Insert\'94 for inserting text. \
\
By default Vim starts in Command mode, so while the cursor can be moved text can't be entered. To switch to Insert mode press the "I" key followed by the text you wish to type. When you are done, press the Escape key to enter Command mode and type":wq" to save changes and exit Vim. \
\
\
\
\
\
\
Just like nano, you can open a file in Vim by suppling its path as an argument: \
 \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
Vim Keyboard Shortcuts\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Vim is preferred by many users due to its command capabilities and minimalism. While Vim may seem obtuse and overly complex at first use, its usability improves as a better understanding of the Command and Insert modes is attained. The most common commands used in Vim's command mode are listed below.\
Insert Mode: i\
Replace character: r\
Delete Character: x\
Delete Line: dd\
Copy Line: yy\
Paste Text: p\
Go To End: G\
Go To Top: 1G\
Search: /\
Quit and Save: wq\
Quit Without Saving: q! \
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 The \'93top\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "top" command is very useful for checking system resource usage and currently running processes. While top does accept a few options, it is most commonly used without them. Lacking supplied options, top will run in its default CPU-usage sorting mode: \
\
Each column tracks a different metric, while each row details a single command.\
The PID column indicates the process ID of the command listed to the right, which can be used with commands like "kill" that accept PIDs as options.\
%CPU shows the current percentage of CPU the command is using. \
TIME counts the amount of time the command has actively engaged the CPU.\
MEM lists the physical memory consumption of the command.\
The remaining columns list other useful data, the specifics of which are available in top's manual pages.\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 The \'93file\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 When interacting with the system you will occasionally come upon a file format that you haven't seen before. Rather than relying on guesswork, the handy "file" command can provide insight. Simply provide the file\'92s relative or absolute path as an option, and file will return useful info about the file: \
\
file is commonly used only with a relative or absolute file path as options, but other options are available. More options are listed in file's manual pages.\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 The \'93rm\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "rm" command is used to delete files and directories. In the most basic usage, "rm" can be used to delete one file by supplying the relative or absolute path(s) as options:  \
\
This would be tedious for any anything more than a handful of files or a directory, so a recursive mode is present as well. Be careful when using it, as items removed with rm can not be undeleted. To use the recursive mode, supply the "-r" option followed by the directory to delete: \
 \
You\'92ll notice that in the example provided above, the rm command refuses to remove a directory unless the \'93-r\'94 option is supplied. This is mostly in the name of safety, as without it a single misspelling could wipe out an entire filesystem.\
\
\
\
\
\
\
\
Recursive mode is exceptionally useful, but can easily destroy a filesystem if the file or directory path options are not properly specified. The "-i" option can be used to help avoid accidents, by causing rm to prompt for each file before deletion:  \
\
\
In the event multiple files with similar names need deleted, rm supports a UNIX convention known as wildcards. Wildcards are symbolized by "*" and indicate that anything matching before or after the wildcard should be acted upon by the command. Like recursive mode, exercise caution when using wildcards to prevent unintended deletion. The following examples show rm being used to remove all files ending in "html" and then all files starting with \'93grom\'94:   \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \uc0\u8232 The \'93sudo\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 "sudo" is short for "switch user do" and allows a user with the proper permissions to execute a command as another user. It is most commonly used to execute commands as the highly privileged "root" account. The root account is roughly equivalent to the administrator account found on Windows, and should only be used when necessary. To execute a command with sudo just place it before a command.\
This example will execute the "whoami" command as the root user. When prompted, enter your account password: \
\
Notice that the output of the command is "root", as it is the root user invoking the command. When the command is executed a second time without sudo, it returns the current user\'92s name.\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 The \'93ps\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "ps" command provides information about running processes. ps is most useful for determining a processes's Process ID (PID), but it can also display CPU time and the Bash session controlling it. Executing ps without options will cause it to only show command processes for the current Bash shell: \
\
\
\
\
\
\
\
\
\
In some cases you will want to see the processes started by other users (or the system) in addition to your own. The "-A" option can be provided to show all processes on the system: \
\
In both use cases, the PIDs are listed to the left of the TIME measurement and command. The PID can be used as options in other commands such as "kill". \
\
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 The \'93kill\'94 Command\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Although "kill" seems rather straightforwardly named, it in fact does not directly 
\f3\i \cf3 \strokec3 kill
\f2\i0 \cf3 \strokec3  anything. The kill command actually sends signals to processes based on their PID. kill can be used with only a PID as the provided option, in which case it will send a SIGTERM to the process with that PID: \
\
In the event the PID does not correspond to an existing process, or if the process is running with higher privileges than the user invoking the kill command, appropriate errors messages will be produced. In the event kill is unable to terminate a process due to privileges, appending the sudo command can resolve the situation.\
\
\uc0\u8232 \
\
\
SIGTERM asks the process to terminate itself, but as to whether that request is honored depends on the command that started the process. In the event the process is not responding or can't respond to requests, kill can resort to more extreme methods like SIGKILL (Signal Kill). SIGKILL signals are handed by the kernel directly, and result in the kernel forcefully destroying the process. Using the "-9" option with kill will specify the use of SIGKILL over SIGTERM: \
\
You should avoid using SIGKILL when possible as it does not give the process the opportunity to gracefully shut down. Traces of a SIGKILL'ed process may be left lying around the system. Additional signals and their meaning can be found in kill's manual pages.\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Binaries and App Bundles\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 While macOS is distinctly UNIX in the command line, software installation and dependency resolution is handled much differently. Instead of bare binaries that depend on external packages, macOS apps are self-contained bundles containing all the software needed for that particular app. App Bundles are a wonderful way to handle the problem of "dependency hell", removing the burden from the user and onto the developer.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Anatomy of an App Bundle\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 App Bundles are actually multi-level directories, but Finder attempts to hide this without hindering more experienced users. To see the contents of an App Bundle, right-click or Ctrl+Click an app's icon. Finder will descend into the app bundle, and navigate within it just like a normal directory. All App Bundles must adhere to the following basic structure: \
\
In every App Bundle, an Info.plist (Note the capital "I") is present. This file stores configuration info about the Bundle. Additional directories may be present, such as "Frameworks" or "PlugIns" that store additional data required by the app.\
\
\
\
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
 Chapter Two: Secure Accounts and Groups\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Users and groups are critical to the viability of a multi-user operating system like macOS. They allow multiple people to have access to the system at the same time, while preventing them from accessing each other's data. By the design of its kernel, macOS inherits FreeBSD's user and group implementation. A brief description of what a user and group are is provided for those unfamiliar with UNIX-style systems.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Users\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 A macOS user is much like the account concept found in most other operating systems. User's accounts are meant to act as containers, isolating and storing their data from other users while allowing them to share a single set of hardware. Users can be have restrictions placed on them individually or by the group they are in.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Groups\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Groups are a mechanism to manage users in a convenient manner by literally 
\f3\i \cf3 \strokec3 grouping
\f2\i0 \cf3 \strokec3  them together according to the abilities and access you want them to have in common. Instead of modifying the permissions of multiple users once at a time, place users into groups and then modify the group's permissions as needed. macOS comes with many groups configured by default to fulfill particular needs within the system. \
\
\
\
\
A list of all the groups can be viewed using the "dscacheutil" command with the "-q" and "group" options: \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 You will notice that there are in fact several hundred groups in use, even on a freshly installed system! In a vast majority of cases these default groups do not need (and should not be) modified unless sufficient reason exists. \
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 User Account Types\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 macOS accounts come in five types: Standard, Administrator, Managed, Guest, and Sharing. A sixth account called "root" exists, but it is a special user meant only for administrator tasks and access. Additional account types do exist, but are used only for specific purposes.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 The Root Account\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 As covered previously, the root account found on macOS systems is heavily restricted in the name of security. However, the root account still has the ability to modify system-wide settings and exert control over other users. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Log Into The Root Account\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Most interaction with the root account is through the "sudo" command, but it is possible to log into the root account directly. This ability is disabled by default, but can be enabled using the Open Directory Utility app.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Enable root Using The GUI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 This utility is accessible from the Users & Groups pane in System Preferences. Start by selecting the Login Options button in the lower left, then click the Join button at the bottom. From this menu you can access the Open Directory Utility:\
\
\
\
\
\
\
Unlock the menu using the lock in the bottom left, then navigate to the menu bar and find the "Edit" menu. Within this menu is the option to "Enable Root User". Selecting this will prompt you to set the password for the root user:\
 \
\
\
\
\
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Enable root Using The CLI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "dsenableroot" command is the simplest means to enable root login using the command line. The command does not require the use of any options to achieve this: \
\
Executing the command will prompt for the administrator password, followed by the password that will be used to secure the root account.\
While it is best practice to use "sudo" whenever possible, in some situations a login-accessible local root account is indispensable. While the situation was exceptional, an example is a privilege escalation bug discovered in High Sierra that allowed unauthenticated users to log into the root account by simply supplying a blank password.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Administrator Accounts\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 By default macOS has one account, which users are required to create during setup. This account is automatically assigned Administrative privileges. While Administrators are not given complete access to the system, they are able to change settings for other users (system-wide) and can access any standard user's files. Administrators also have the powerful ability to spawn shells and run commands with the permissions of the root user via the "sudo" command. In short, Administrators are given an extreme but not unlimited level of authority.\
In terms of configuration, the only difference between an Administrator and a Standard account is membership within the "admins" group. The permissions assigned to the admins group will be inherited by any users added to it. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Standard Accounts\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Standard accounts are the most commonly used account in multi-user environments, and are intended for use in situation that require some users to be limited to specific scopes of access. Standard accounts are by default restricted to accessing only the settings and files directly related to them, and may not make changes to the system that affect other users. \
Of particular note, standard accounts are not allowed to install apps globally to  				/Applications. They may still execute apps from directories they own however, such as the personal applications folder in ~/Applications. \
Shells are also spawnable by standard users, but they do not have access to the commands that require the use of administrator credentials, such as the "sudo" command.\
It is recommended that administrators use a standard account for daily activities, and switch to the administrator account only when needed. This separation of powers can limit the scope of an attack, and in the event of user error can also prevent accidental damage to the system.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Managed Accounts\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Managed accounts are simply Standard accounts with additional restrictions placed on them by an Administrator using the Parental Controls located in System Preferences. This type of account is useful for kiosks and other single use machines, but should not be relied on as a complete security mechanism.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Guest Accounts\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Guest Accounts are temporary accounts who's personal files and settings are erased after logout. They serve vital functionality to Find My Mac, but also present a security risk when enabled as they allow standard user level access to the Mac without entering a password. Any privilege escalation attacks that would work against a standard account will work for guest accounts too, so weigh your options accordingly.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
Sharing Accounts\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The Sharing account is used only for sharing files across the network. It cannot be used to log into the local Mac, or make changes to settings. The sharing user can be given additional privileges by an administrator to perform actions like screen sharing or remote device management.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 GUI Account Management\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Managing individual accounts can be done graphically using the Users and Groups Pane in System Preferences: \
\
The left side of the pane contains a list of the users on the system, while the right side displays details about the currently selected user. By default, the current user is selected. To modify settings in this pane, you may have to authenticate by clicking the padlock in the lower left. \
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Creating Accounts\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 You can create accounts by clicking the "+" icon located in the lower left beneath the house icon. The account creation menu drop-down will appear, allowing you to choose details for the new account:  \
\
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Removing Accounts\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Home users may not remove accounts often, but in enterprise environments extreme care must be taken to ensure old accounts aren't left on the system. Abandoned or unneeded accounts are prone to hijacking or abuse, and increase the attackable surface area of the system.\
To remove an account, click on the account in the list to select it, then click the "-" icon in the lower left:  \
\
You will be presented with a dialogue menu confirming the deletion, and specifying what actions will be performed on the account. \
\
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 CLI Account Management\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 \
Those experienced with UNIX-like operating systems may feel more comfortable managing users from the command-line, rather than the graphical interface. Command-line based account management offers precise control, and can be accessed via remote shell or even automated with scripts. There are multiple ways to manage accounts using the command line on macOS, but the Open Directory service will be the primary method covered. To invoke the Open Directory service, use the "dscl" command: \
\
By default dscl launches in interactive mode, where it will accept commands and reply with the results. A non-interactive mode can be accessed by supplying options. \
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
Creating Accounts with the CLI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 There is no single command within dscl to create a user. The necessary attributes (ID, path, membership, etc. ) must be manually specified using additional options. \
The first step to creating an account is the "-create" option, followed by the desired path of the account. In normal circumstances, this will be within the "/Users" directory: \
\
You'll notice the period between the dscl command and the -create option. This tells dscl the location of the datasource containing the data about each account. A period or "localhost" indicates the datasource is present locally.\
\
\
\
\
It is recommended to set a password at this point to prevent anyone from logging into the newly created account. This can be achieved by using the "passwd" command, with the username supplied as an option: \
\
\
\
\
\
\
\
\
\
\
\
Next, a default shell must be assigned. This will be Bash in most cases. Set the default shell using the "UserShell" option after the username path, followed by the shell to be set. The other parts of the command will be the same as used previously: \
\
\
\
\
\
\
\
\
\
\
Now that the shell has been set, we will add the real name to the account to aid in easy identification of the user. Supply the "RealName" option after the user path, followed by the desired name in quotes: \
\
\
\
\
\
\
\
\
\
\
Now the unique ID (UID) must be set to uniquely identify the account. This must be a number, and not in use by any other account. Since we are working within a shell, we can use the built in tools "sort" and "head" to help find a number not in use: \
\
With the output of this command you can see the user with the highest UID. Use this to guide you in your selection of a UID. In the example provided above, it would be appropriate to choose a UID of \'93505\'94. It is advised to always select a UID higher than 501, as the UIDs below it are intended for use by the system. If you do create an account with a UID under 501,  it will not show in the LoginWindow, although it may still be logged into.\
\
\
\
\
\
\
Set the UID using the "UniqueID" option after the user path, followed by the integer number: \
\
\
\
\
\
\
\
\
\
\
\
In most UNIX-like operating systems, a primary group is used to determine the inherited permissions of any processes or files created by a particular account. macOS instead prefers to set inherited permissions based on the group membership of the parent directory. Even if an account were to be assigned membership to a privileged group such as "staff" (PrimaryGroupID of 20), it will be overridden by other permissions. The primary group ID is important nonetheless, so how to set it will be covered.\
Like the UID, the primary group ID must be a whole number, but unlike the UID it must be in use by a group. This group's members will have access to the account's files and processes in accordance with the group's permissions. To set the primary group use the "PrimaryGroupID" option, followed by the group's ID: \
\
The recommended default is PrimaryGroupID 20, as it is the normal primary group for standard accounts. The admin group is assigned to ID "80".\
\
\
\
The account's home directory must now be assigned to contain the account's personal files. Specify the home directory using the "NFSHomeDirectory" option, followed by the file path for the home directory: \
\
\
\
\
\
\
\
\
\
\
Lastly, the group membership will be assigned based on the permissions we want the account to have. While any group name can be used, for the example provided the "admin" group will be assigned to give the account administrator privileges. To assign membership to a group, use the "-append" option instead of the "-create" option used thus far, and provide the path of the group followed by the "GroupMembership" option and the username of the account: \
\
The account will have now been successfully created, and ready for further configuration if necessary.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
Removing Accounts with CLI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Removing an account is fortunately much simpler than creating one, and uses many of the same commands. Deleting an account involves removing it from the Open Directory Service database, then deleting the accounts home folder. We'll start with the former first. Remove the account using the dscl command, followed by the "-delete" option and the path of the account. The "kojima" user will be used as example: \
\
\
\
\
\
\
\
\
Now that the account no longer existed we must remove the leftover personal files using the "rm" command with the "-rf" to "remove forcefully" the files:  \
\
The account itself is now completely removed, but any files or processes remaining on the system created by it will still remain.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 GUI Group Management\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Groups can be managed graphically in a manner similar to users using the the Users & Groups pane in System Preferences. The options for configuration aren't nearly as robust, but basic operations such as creation, removal, and adding and removing users are present.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 GUI Group Creation\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Groups can be created graphically in a similar manner to accounts, by using The Users & Groups pane in System Preferences. Just as with accounts, the "+" icon located in the bottom left can be used to create groups. To create a group just select "Group" from the "New Account" drop-down menu. You can only choose the group's name in this menu, additional configuration is performed from the main pane: \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\pard\pardeftab720\sa280\qc\partightenfactor0

\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Add and Remove Accounts From Groups With The GUI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Accounts can be added to groups using the main Users & Groups pane. Groups are listed to the left in a separate section. Select the group you wish to modify and check the boxes next to the users you would like to add to the group. To remove a user, simply uncheck the box next to them: \
\
Don't forget that user can be in multiple groups at once, with overlapping permissions.\
You'll notice that beyond adding and removing users, there aren't any other configuration options for groups available within the Users & Groups pane. Graphically customizing a group further requires the use of the Directory Utility.\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Edit Group Attributes Using The Directory Utility\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Individual attributes of groups can be edited using the Open Directory Utility located in the Users & Groups pane of System Preferences. Select the Login Options button in the lower left of the pane, then click the "Join" button next to "Network Account Server" and choose "Open Directory Utility\'94.\
From the Directory Utility, switch to the Directory Editor tab to list the records stored in the Open Directory database. The "Viewing" drop menu in the top left can be changed to "Groups" to view all the groups on the system. Select the group you wish to edit the attributes of: \
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 CLI Group Management\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Group attributes can also be edited using the command-line version of the Directory Service, which is accessible through the dscl command. Editing group attributes is very similar to editing user attributes, and most of the command syntax is the same. The best place to start editing groups with dscl is to list them using the "-list" option followed by the "/Groups" option: \
\
Remember that the "." signifies that the database we are directing dscl to is stored locally, don't forget to declare it when using dscl.\
\
\
\
\
\
\
Now that we know what groups exist, we can begin editing their attributes. The attributes of a particular group can be listed by using the "-read" option and providing the path to the group:  \
\
\
\
\
\
\
\
\
\
\
\
Group attributes can be changed using the "-change" option. In this example, we are changing the PrimaryGroupID: \
\
\
\
\
\
\
\
\
\
\
\
Existing users can be added using the append command to literally append the username to the "GroupMembership" attribute: \
\
\
\
\
\
\
\
\
\
\
\
Removing a user is also simple, just remove the username from the "GroupMembership" attribute: \
\
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
Additional Methods to Secure Accounts\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Securing accounts doesn't just end with the accounts themselves. For accounts intended for human usage, additional steps can be taken to help prevent a user's mistakes or even maliciousness from resulting in a breach. While the following points are hardly exhaustive, they are mentioned to remind you of a few "best practices" when dealing with human users.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Establish Password Policies\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 A strong password policy provides an enforceable set of rules to prevent account compromise. While experts may disagree as to what constitutes a "strong enough" password, don't fall into the trap of extremes. Of course a weak password will be trivial to break, but passwords that are too complex will encourage users to write them down or re-use them. Use your judgement to craft a password policy sufficient to protect the device, but not so complex as to be self-defeating. Generally speaking, passwords should not contain personal information, should not contain dates or name, and should contain at least one digit or special character.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Require Login Passwords\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Enforcing the requirement of login passwords prevents accounts from becoming compromised by other users, or being accessed by opportunistic passerby. Kiosk devices or other public machines that cannot have passwords must be hardened so that only relevant data can be entered. Devices without passwords should not be allowed access to sensitive data. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Automatic Logout\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Automatic logout works hand in hand with login passwords requirements to prevent unauthorized access. Time limits for automatic logouts should be set as low as possible while not interfering with normal usage. It is wiser to set a too low limit than a too-generous one. It may also be helpful to keep records of when a device must lock itself due to timeout to assist you in fine-tuning the time delay. \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Grant Least Privilege\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Accounts and Groups should only be granted the least amount of privileges needed to perform their tasks. Any additional privileges creates a larger potential for abuse, and makes breaches more wide reaching than if minimal privileges were assigned. If a single user requires access to multiple data resources that have different levels of security value, requiring the use of multiple accounts to compartmentalize access can limit accidental overreach.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Prevent Privilege Creep\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Groups should be audited regularly to prevent old accounts from building up, and to prevent accounts from exceeding the privileges needed in their current job roles.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
Two-man Access\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Two-man access refers to the practice of requiring two independent persons to access a resource. This can prevent a single malicious user from compromising the data, but adds complexities regarding recovery plans and increases the time and work required to use the data.\
 \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Role Rotation and Randomization\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 If multiple users have the capability to work with multiple sets of resources, randomly rotating their work roles can act as a natural auditing system to prevent abuse of the resource. Role rotation depends on trust in the same way that two-man access does, and assumes you have a compatible workflow for its implementation.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
\
\
UNIX File Permissions\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Since we've covered the basics of accounts and groups, it is now time to learn how they are used to limit access to resources. On most UNIX-like systems (macOS included), every resource is abstracted as a file. File permissions can be used to provide fine-grained controls over who can access a resource, and in what ways. While macOS maintains most file permissions automatically, there will arise situations that require you to change them. This section will cover the basic attributes and their meanings, as well as re-iterate methods to check and change them.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Display File Permissions Using The CLI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "ls" command covered in Chapter One is the primary means of displaying file permission attributes within the command-line. Providing the "-l" option will cause ls to list the file permissions in addition to the directory contents. The example below demonstrates "ls -l" ran within the home directory for the user \'93dipper": \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
Reading File Permissions\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The output of ls is sorted into multiple columns based on the type of data.  The first column displays the permissions for the file or directory named in the far right column: \
\
\
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Understanding Symbolic Notation\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Permissions can be represented in two ways: Numeric (AKA octal) or symbolic. The ls command uses the more common symbolic notation. Symbolic notation operates on the concept of permission "triads", a method that works by grouping the characters that symbolize each permission into threes: \
\
The first triad explains what the owner of the resource can do, the second triad explains what group members can do, and the third triad explains what any other accounts can do. The characters in each triad describe the permissions for that triad:\

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrt\brdrnil \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat5 \clwWidth6420\clftsWidth3 \clheight340 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf6 \clbrdrr\brdrnil \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat5 \clwWidth6440\clftsWidth3 \clheight340 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrnil \clbrdrb\brdrs\brdrw20\brdrcf6 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f0\b\fs24 \cf3 \strokec4 The Permission Triads
\f4\b0 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f0\b \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec4 What The Triad Describes
\f4\b0 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight300 \clbrdrt\brdrs\brdrw20\brdrcf6 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth6420\clftsWidth3 \clheight300 \clbrdrt\brdrs\brdrw20\brdrcf6 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 First Triad
\f4 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 What the resource owner can do
\f4 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight260 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat10 \clwWidth6420\clftsWidth3 \clheight260 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 Second Triad
\f4 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 What the group members can do
\f4 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrt\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight280 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth6420\clftsWidth3 \clheight280 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 Third Triad
\f4 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 What any other accounts can do
\f4 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 
\f2\fs32 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 \cell \lastrow\row
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0
\cf3 The last character is each triad is special as it can be one of multiple values: x, s/t, or S/T. These represent the ability of the resource to be executed as a program, and whether or not the resource has a SETUID or SETGUID flag set.\
\
\
\
\
To help you better understand symbolic notation, a few example notations with their corresponding "English" meanings are listed below:\

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrt\brdrnil \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat5 \clwWidth6420\clftsWidth3 \clheight440 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf6 \clbrdrr\brdrnil \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat5 \clwWidth6440\clftsWidth3 \clheight440 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrnil \clbrdrb\brdrs\brdrw20\brdrcf6 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f0\b\fs28 \cf3 \strokec4 Triad Characters
\f4\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f0\b\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec4 Character Meaning
\f4\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf6 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf6 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 -
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 No Permission
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat10 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 r
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Resource is readable
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 w
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Resource is writable
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat10 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 x
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Resource can be executed as a program
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight740 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth6420\clftsWidth3 \clheight740 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 s/t
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Resource is executable and has a SETUID/SETGUID flag
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrt\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight740 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat10 \clwWidth6420\clftsWidth3 \clheight740 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 S/T
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Resource is not executable but has a SETUID/SETGUID flag
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 
\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 \cell \lastrow\row
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The SETUID/SETGUID flag is a special flag that allows one account to execute or access a resource with the permissions of another account, without having too authenticate as that account. A common use for SETUID/SETGUID is utilities that require special access to system interfaces or resources, but are intended for use by even standard accounts. The "ping" command is such a utility because it must interact with the system's networking interface, but is useful to all accounts as a basic testing tool.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Understanding Numeric Notation\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 In the previous chart, you'll notice that a column labeled "Numeric Notation" is present. This corresponds to each Symbolic notation's equivalent Numeric notation. Numeric notation is used by certain utilities like "chmod", which is the command used to set permissions. The reason for this difference in notation is one of ease of use. In situations where permissions must be read, symbolic notation is commonly used, whereas in situations where permissions are set numeric notation is used.\
\
\
\
\
\
Numeric notation is also known as octal notation because it because it operates on the binary sum of octal bits. This may sound confusing first, but just remember it all comes down to addition. The read bit adds 4 in binary, represented as 0444. The write bit adds 2 in binary, represented as 0222. The execute bit adds 1 in binary, represented as 0111.\
\

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrt\brdrnil \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat5 \clwWidth6420\clftsWidth3 \clheight440 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf6 \clbrdrr\brdrnil \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat5 \clwWidth6440\clftsWidth3 \clheight440 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrnil \clbrdrb\brdrs\brdrw20\brdrcf6 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f0\b\fs28 \cf3 \strokec4 Individual Numeric Codes
\f4\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f0\b\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec4 English Meaning
\f4\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf6 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf6 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 0444
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Read
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat10 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 0222
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Write
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrt\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 0111
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Execute
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 
\f2\fs32 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 \cell \lastrow\row
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0
\cf3 \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Adding Downwards\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The codes can be added downwards to combine their permissions, like so:\

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrt\brdrnil \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clshdrawnil \clwWidth4560\clftsWidth3 \clheight320 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs26 \cf3 \strokec3 Anyone Can Read: 0444
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat10 \clwWidth4560\clftsWidth3 \clheight340 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs26 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 +
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clshdrawnil \clwWidth4560\clftsWidth3 \clheight320 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs26 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Anyone Can Write: 0222
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat10 \clwWidth4560\clftsWidth3 \clheight320 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs26 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 \'97\'97\'97\'97\'97
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrt\brdrnil \trbrdrr\brdrnil 
\clvertalt \clshdrawnil \clwWidth4560\clftsWidth3 \clheight320 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs26 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Anyone Can Read and Write: 0666
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 
\f2\fs32 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 \cell \lastrow\row
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0
\cf3 Another example:\

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrt\brdrnil \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clshdrawnil \clwWidth4560\clftsWidth3 \clheight320 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs26 \cf3 \strokec3 Anyone Can Read: 0444
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat10 \clwWidth4560\clftsWidth3 \clheight320 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs26 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 +
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clshdrawnil \clwWidth4560\clftsWidth3 \clheight340 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs26 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Anyone Can Execute: 0111
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat10 \clwWidth4560\clftsWidth3 \clheight320 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs26 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 \'97\'97\'97\'97\'97
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrt\brdrnil \trbrdrr\brdrnil 
\clvertalt \clshdrawnil \clwWidth4560\clftsWidth3 \clheight660 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs26 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Anyone Can Read and Execute: 0555
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 
\f2\fs32 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 \cell \lastrow\row
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0
\cf3 The permissions for groups and other users is determined by the digit in each position, similar to the triad concept used by symbolic notation.\
\
\
The second digit determines the resource owner's permission:\
0 [0] 0 0\
The third digit determines the group's permission:\
0 0 [0] 0\
The last digit determines anyone else's permission:\
0 0 0 [0]\
Thus in the case of the example permission of 0740, it can be broke down like so:\
[0] [7] [4] [0]\
The 7 represents the resource owner's permission.\
The 4 represents the group's permission.\
The 0 represents anyone else's permission.\
Putting it all together, the owner can read, write, and execute, the group can read, and anyone else has no permission to access the resource.\
\
\
\
\
\
\
\
\
\
\
The image below has the octal permissions for a directory displayed, followed by the symbolic permissions for the same directory. See if you can match up the permissions, or convert them mentally: \
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
\
\
\
\
\
\
Editing File Permissions From The CLI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Now that we know how to read file permissions, we can set them to the values we desire. The primary means of doing so is with the "chown" and the "chmod" commands. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Changing File Ownership with chown\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "chown" command modifies who owns a particular resource, and the group associated with it. The chown command accepts the account and group names separate by a ":" as the first option, followed by the path to the resource. If you do not wish to declare a group, simply provide the account name by itself. The following example shows chmod changing the ownership of \'9321groms.mp4" to the user "dipper", and the group \'93DallasBuyersClub": \
\
\
\
Here is an example of changing the ownership to the user "shariolis", but keeping the "DallasBuyersClub" group: \
\
File ownership is important because it sets the stage for how the resource permissions can be interacted with in the future, and whether or not a particular person can modify them. If changing the permissions of a file fails, it may be because the account you are logged in as does not own the file.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Changing File Permissions with chmod\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The "chmod" command is short for "change mode", with "mode" being a legacy term for file permissions. "chmod" accepts options in different sequences depending on the permissions notation you intend to provide. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Symbolic Notation\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 If you are using Symbolic Notation, the command expects the desired permissions to be supplied first in a special format. The required form is as follows: The letter "u", "g", and "o" stand for user, group, and others, respectively. Use the character for who's permission you wish to set, and follow it with an "=" sign and the triad notation. The following example will set the "grom.log" file to have read, write, and execute permissions for the user, read and execute permissions for the group, and read permission for anyone else: \
\
Some files may be owned by other users, you can change their permissions by switching to their account or by temporarily switching to the root account by prepending "sudo" before the command.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Numeric Notation\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Numeric notation is a bit simpler to declare, with chmod expecting the notation to be provided before the file path. You may enclose the path in quotes if delineating characters or whitespace is present. The following example sets the permissions of grom.log to 0754, which allows the owner to read, write, and execute, the group to read and execute, and anyone else to read only:   \
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
Editing File Permissions From The GUI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The permissions for a particular file or directory can be obtained graphically by right-clicking on the object in Finder and selecting "Get Info".  \
\
At the bottom of the "Get Info" window, select "Sharing and Permissions". The current permissions are listed in a natural language format, with drop-down menus to modify them. \
Additional permissions can be added using the plus button, and the gear button exposes options for recursive permissions and an undo function. Before changes are allowed to be made, you may have to click the lock icon and authenticate as the account who owns the file.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
\pard\pardeftab720\sa280\qc\partightenfactor0

\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
Chapter Three: Secure Base Images  and Deployment\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 When establishing a secure system, it is important to start from a fresh state to ensure reproducibility, and to prevent any prior configurations from introducing flaws into the security measures you implement. Obtaining secure images for this purpose is fairly simple, and in the case of options like Internet Recovery, almost completely automated. The following section will briefly detail how to create external installation media from a macOS installer, and the automated installation of a verified image using Internet Recovery.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
Create External Installation Media\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 External installation media has the benefit of not requiring an active internet connection, and being limitlessly re-usable. It may not be the best option when working with multiple Macs at once, but it is an invaluable when Internet Recovery is not available. A bootable macOS environment can also make troubleshooting of a non-booting installed system possible.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Obtaining The Installation App\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 I\cf3 \cb11 \strokec3 nstaller downloads for recent versions of macOS can be found within the Mac App Store by using the search function. For Macs running High Sierra and older, installers for previous macOS releases are listed in the purchase history. macOS Mojave changes this behavior however, and does not offer the option to download older macOS versions. Enterprise administrators can download installers directly from Apple, but normal users are limited to the facilities offered within macOS. Various 3rd party tools exist to download install images directly from Apple\'92s servers, but as unofficial tools they may stop working or lose support at any time. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \cb11 \kerning1\expnd10\expndtw52
\strokec3 Verifying the Installation App\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \cb11 \expnd0\expndtw0\kerning0
\strokec3 Regardless of how you obtain the images, you will want to verify their authenticity before proceeding to use them. The installers are verified by the T-series chip and self-signing mechanisms, but a manual check is always recommended. The best methods to do this is through SHA signature checking of the DMG file, or by executing the \'93codesign\'94 command against the installer\'92s app bundle. Provide the codesign command with the \'93-vvvd\'94 option, followed by the path to the installer\'92s app bundle: \
\
Within the command\'92s output, make note of the values of the \'93Authority\'94 entries. Apps with a valid digital signature will list \'93Software Signing\'94, \'93Apple Root CA\'94, and \'93Apple Code Signing Certification Authority\'94 within those entries. If an installer lacks these, assume it has been stripped of it\'92s code signing and possibly tampered with.\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \cb11 \kerning1\expnd10\expndtw52
\strokec3 Creating the Installation Media\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \cb11 \expnd0\expndtw0\kerning0
\strokec3 Now that the macOS installer has been acquired and verified, it can be written to an external USB drive for installation on any number of devices. Modern versions of macOS require a USB drive that is at least 8GB in size, but finding one this large shouldn\'92t be difficult at all. Simply insert the USB drive, and locate the \'93createinstallmedia\'94 program within the installer\'92s app bundle. The program is typically stored in the \'93/Contents/Resources\'94 directory. Provide the full path to the program, and provide the program with the \'93\'97volume\'94 option, followed by the path to the USB drive. The following example assumes a macOS Mojave installer, and a USB drive called \'93Rhapsody\'94: \
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f4\fs24 \cf3 \cb11 \strokec3 \
\
\
\
\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\fs32 \cf3 \cb11 \strokec3 \
The media creation process may take a significant amount of time, based on the speed of the drive. When the process is complete the program will output something to the effect of the installation media \'93being available\'94. Eject the USB drive using Disk Utility or Finder before physical removal. The USB is now ready to install macOS on any compatible Mac. \
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0
\cf3 \cb1 \strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
\
\
\
\
\
\
\
Internet Recovery\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 On individual Macs the easiest means to achieve a secure base system is through Internet Recovery Mode. Internet Recovery downloads a copy of the macOS base system from Apple servers, and verifies its authenticity before installation. Newer Macs that contain T-Series security co-processors, are capable of performing more robust verification of the downloaded image. Be aware that this feature requires an active internet connection however, and also sends data about the Mac in plaintext over the connection interface. For this reason, it is recommend to perform Internet Recovery only on a known-secure network. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Initiate Internet Recovery\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 To enter Internet Recovery Mode, boot the Mac while holding Command+Option+R. The Mac will to boot to a blank screen with a globe icon. At this point you may be prompted to select a network to connect to:  \
\
\
\
After the Mac has successfully connected to the internet and downloaded a minimal macOS image, you will be presented with a screen prompting you choose the disk to install the downloaded macOS system to: \
\
This process may take several minutes depending on the speed of the internet connection. When the process is complete, the Mac will automatically reboot into the Setup Assistant.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
\
\
\
\
\
Mass Image Deployment and Mobile Device Management\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Deploying custom or verified macOS images to multiple Macs  at once was commonly achieved using NetBoot servers. With the release of the T-series chip, this method of image deployment and distribution is no longer possible due to the verification requirements of the T-series chip. With the increasing use of this chip across Apple\'92s Mac line, NetBoot can no longer be considered viable. Instead of NetBoot servers, Apple expects administrators to make use of the Device Enrollment Program, and implement Mobile Device Management profiles to customize deployed systems.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Creating a DEP Account\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 DEP accounts only hard requirements is the registration of the enrolling organization with the Data Universal Numbering System (DUNS). DUNS is a database maintained by Dun and Bradstreet Corporation to uniquely identify business entities. Obtaining a DUNS number may be free, but the process can be lengthy. Assignment of a DUNS number may take up to 30 business days. While you or your organization may be in a situation where it does not require a DUNS number (such government agencies or contractors), this is the exception rather than the norm. Apple\'92s DEP signup page can be located using the search function built into Apple\'92s main webpage at Apple.com.\
\
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Linking an MDM to a DEP Account\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Once a DEP account has been created, a MDM suite must be linked to the account using a security certificate. This certificate must be requested from within the MDM suite, or manually obtained from Apple\'92s certificate request page. The supplied certificate must then be loaded into the MDM suite. It may take some time for Apple\'92s servers to recognize the MDM suite once linked, but this usually only takes a few minutes.\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardeftab20\partightenfactor0

\f4\fs24 \cf3 \strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Enroll Devices\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 After linking the DEP account and the MDM suite, log into Apple\'92s DEP web portal and assign the devices you wish to the MDM suite\'92s server. After assigning the devices, return to the MDM suite and trigger a sync to ensure the newly assigned devices are recognized. At this point, the devices are ready to receive configuration commands.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Pushing Configurations\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The process for configuring devices through the MDM suite depends entirely on the suite being used, but generally speaking the process consists of selecting options from a GUI and uploaded any needed scripts or external data. No particular MDM suite is named here in the sake of neutrality, but many well-made options exist in the market. You are encouraged to do personal research to determine the best MDM suite for you or your organization\'92s needs.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\
\
 \
Chapter Four: Securing The Base System\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Compared to its NT-based competition, macOS enjoys a reputation of extreme security and malware resistance. While this is to some degree true, macOS is far from immune to all of the security threats present in the modern world. This section will focus on securing the system and related services, but not individual apps. Securing apps will be covered in Chapter Five: Securing The User Space.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 A Note About Device Profiles and Policies\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Nearly all of the methods detailed in this chapter can be implemented using one of the numerous MDM suites offered by third party vendors. No particular suite is recommended, but it is recommended that you create a desired feature list before buying into any particular suite.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs46 \cf3 \kerning1\expnd18\expndtw92
\strokec3 Secure System Services\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The macOS base system is configured to a relatively secure state out of the box, but many changes and methods can be applied to increase it further. This section attempts to take an ascending approach, with topics related to things deep in the system being discussed first. Our first topic will be the Quick Look cache.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Quick Look\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 To provide Quick-Look functionality in Finder, file contents are scanned and a database is generated that contains a thumbnail to represent each file's contents. The issue with this database is that its contents are stored unencrypted, even for thumbnails that are generated from files on encrypted drives or containers.\
The database itself is stored deep within the \'93/var\'94 directory, but can be located using the \'93find\'94 command and \'94$TMPDIR../C/com.apple.QuickLook.thumbnailcache/\'93 as an option. Supply the \'93-type f\'94 and \'93\'93-name \'93index.sqlite\'94\'94 options as well to narrow down the results to the exact file we are looking for:  \
\
\
\
\
\
\
The database is in the SQLite format, and can be viewed with any SQLite viewer: \
\
The severity of this data leakage can be partially mitigated by using disk encryption, but the possibility of cold boot attacks on Macs without T-series chips negates this mitigation in situations where the attacker has physical access.\
\
\
\
\
\
\
\
\
The best solution is to disable the service responsible for generating Quick Look previews. The "qlmanage" command with the "-r disablecache" option fulfills this task: \
\
Disabling the service also triggers a reset of the cache database, but you may also delete the file itself to be completely sure. In any case, reboot the Mac to ensure the cache database isn't being held in RAM.\
\
\
\
\
\
\
\
\
To re-enable the Quick Look Cache, execute "qlmanage" with the "-r enablecache" option. \
\
The database will be re-created and will begin immediately repopulating with data.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 \
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Spotlight Suggestions\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 By default, Spotlight sends search queries over the internet to Apple and numerous third parties to recommend \'93Suggestions\'94. Apple claims these queries are sanitized and anonymized for processing, but a data breach or interception of the web traffic containing the queries could give attackers valuable insight about the user\'92s activities.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Disable Spotlight and Suggestions Using The GUI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 To disable Spotlight and Suggestions via the GUI, uncheck the \'93Allow Spotlight Suggestions in Look Up\'94 box located in the bottom of the Spotlight pane in System Preferences. This will keep Spotlight search enabled, while disabling the Suggestions feature. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Disable Suggestions Using the CLI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 It is not possible to disable Suggestions though the command line without modifying system files. In macOS versions higher than El Capitan, System Integrity Protection (SIP) prevents this. The only option is to disable SIP from within Recovery Mode and prevent \'93launchctl\'94 from starting Spotlight at boot. \
Boot into Recovery Mode by holding Command+R during boot. In the menu bar, select Utilities, and launch Terminal: \
\
\
\
\
\
\
\
\
\
Enter the "csrutil" command with the "disable" option to disable System Integrity Protection: \
\
Quit the Terminal then reboot the Mac to continue.\
\
\
\
\
\
\
\
\
\
After the Mac boots again, sign into an Administrative account and open Terminal. Using the \'93launchctl\'94 command, we can control which LaunchDaemons are loaded during boot. Supply \'93unload\'94 and the \'93-wF\'94 option to forcefully unload the daemon, followed by \'93/System/Library/LaunchDaemons/com.apple.metadata.mds.plist\'94, the path to the plist responsible for launching the daemon providing Suggestions functionality: \
\
The daemon will be prevented from loading during future boots.\
\
\
\
\
\
\
\
To re-enable Spotlight use them same command as before, but change the \'93unload\'94 option to \'93load\'94:  \
\
\
\
\
\
\
\
\
\
\
Once Spotlight has been disabled or re-enabled, reboot the Mac into Recovery Mode again and re-enable SIP by executing the the "csrutil" command with the "enable" option: \
\
Boot the Mac normally. Spotlight will no longer launch during boot, and the Spotlight icon will no longer be present in the menu bar.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Siri\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Unlike iOS, Siri's security implications on macOS are rather limited. This may change in future editions of macOS as the virtual assistant becomes more ingrained in the system, but at the present time Siri's greatest risk is encouraging users to speak potentially sensitive information out loud. In in environments where this is not a concern, many security experts still elect to disable Siri on the basis that the less code there is running the less chance of exploitation.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Disable Siri Using The GUI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Siri can be disabled graphically using the \'93Siri\'94 pane in System Preferences. The check box to the right enables and disables Siri: \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
\
\
iCloud\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Due to its deep integration with macOS, iCloud cannot be handled like a traditional cloud syncing service. Everything from encryption keys to location data are potentially stored in iCloud, making it a lucrative target for attackers. Certain facets of iCloud introduce more risk, so careful restriction of user's capabilities are necessary.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Disk Unlocking\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 During setup, macOS presents a rather innocuous option to "Allow my iCloud account to unlock my disk". Intended for use in the event of a lost FileVault2 password, it potentially allows an attacker who's compromised the user's iCloud account to exfiltrate the FileVault2 encryption keys and decrypt the disk. This option should never be enabled, especially since it is possible to recover encrypted disks using centrally managed recovery keys. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Credential Storage\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 iCloud is able to sync Keychain data from synced devices to enable seamless password management across devices. While convenient, this could allow an attacker to compromise every stored password using a relatively easy social engineering or sandbox circumvention attack. A stolen mobile device synced with an iCloud account also has the potential to enable exfiltration of Keychain data.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 File Sharing\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 User and Group controls make fine-grained file access easy to enforce, but iCloud does not make the same distinctions. If a file is shared through iCloud, sharing settings can be selected that give anyone with the link access to the file. iCloud syncing may also expose files to insecure environments if users are logged the iCloud account from an unmanaged device. It is recommended to establish an acceptable use procedure for iCloud in the work environment, and back up such procedure with appropriate restrictions.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Personal Data Syncing\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Personal data such as messages, contacts and addresses may be stored within iCloud if the appropriate options are enabled. While the leakage of such data may seem harmless, it does expose additional information about the user and those they interact with. Of more immediate consequence, the information could be used to conduct social engineering attacks, or be used to guess other information about the user.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Data Encryption\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Encryption is an critical tool to protect data in transit or at rest, and protects such data from eavesdropping or malicious tampering. More often then not encryption is a necessity rather than an opportunity, and the requirements behind it being so may be legal or just plain common sense. If your data is valuable enough to avoid losing, it is valuable enough to encrypt. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Introducing FileVault2\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 FileVault2 is the collective name for Apple' implementations of full disk encryption on Macs. It offers seamless, robust protection for data at rest, suitable for use in both home and enterprise environments. When enabled, it prevents an attacker with physical access from reading the contents of the disk by encrypting the block data. \
Internally, FileVault2 uses a 128-bit AES cipher in XTS mode. Cryptographic data for the cipher is provided by an implementation of the Yarrow pseudo-random number generator within the XNU kernel. Yarrow is periodically seeded with random data by the SecurityServer daemon, which in turn collects entropy from jitter measurements within the kernel. The exact method by which FileVault2 is implemented depends on the filesystem in use (HFS+ vs APFS), but both are functionally the same.\
 This design is very robust, but requires special considerations to ensure maximum security.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
\
\
\
\
\
Enabling Full Disk Encryption Using The GUI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 For individual devices, existing disks can be converted to FileVault2 graphically using the Security and Privacy Pane in System Preferences:  \
\
First, click the lock icon in the lower left to unlock the preferences pane, then click the \'93Turn On FileVault\'94 button, and follow the prompts. \
\
\
\
\
You will be first prompted with a selection screen presenting options for unlocking the disk in the event of a lost password. It is highly recommended to use recovery keys instead of iCloud account unlocking. Store the recovery keys in a safe, secure location, as it is essentially a second password capable of decrypting the disk.  \
Keep in mind that it is also possible to enforce custom (escrow) recovery keys using MDM profiles: \
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
Enabling Full Disk Encryption Using The CLI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 FileVault2 can be enabled through the Terminal by executing the "fdesetup" command with the "enable" option: \
\
Simply follow the onscreen prompts and reboot the Mac to start the encryption process. After reboot, the status of FileVault2 can be checked using the "status" option: \
\
\
\
The usage of fdesetup can be completely automated by passing property list formatted data to stdin (standard input) and supplying the correct options. It is also possible to supply custom encryption keys and institutional recovery keys using the "keychain" and "certificate" options. Most DEP suites support configuring FileVault2 in this manner as well.  \
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Encrypted Volumes\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Encrypted volumes can act as a simple method of compartmentalizing sensitive data, and securing data for transport between devices. Several third-party tools are available for creating encrypted volumes, and macOS itself includes a tool built into Disk Utility for this purpose. No matter which method you use, ensure that Spotlight and Quick Look have been properly modified to prevent caches from compromising the confidentiality of the data.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Encrypted Backups\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Data encryption is important in any environment, even if that data isn't commonly moved or accessed. The static nature of data backups leads many to make the mistake of failing to apply the necessary security measures. Keep in mind that any data valuable enough to backup is valuable enough to steal.\
macOS has a built-in data backup solution called Time Machine. While Time Machine is perfectly capable to meet the needs of the average home user, it does not provide the configuration or management tools necessary for its effective use in large environments. Of particular relevance, there is currently no way to force the use of encrypted backups on user's devices. For this reason it is recommended to investigate the use of a third-party backup solution that does.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Removable Devices\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Removable devices present a particular challenge for security experts due to their ubiquity and extreme portability. As devices converge towards unified connection interfaces like USB and Thunderbolt, the viability of using these devices as attack vectors increases. This section will cover the most common attack methods used with removable devices.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Removable Storage Malware\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Malware that spreads by copying itself to removable drives has existed almost as long as computers themselves. In fact, the earliest recognized computer virus (Elk Cloner) targeted Apple II computers in this way. The exact methods employed have changed, but the overall concept has remained the same: trick the user into executing a malicious app, or exploit software that interacts with a file on the drive. \
Modern macOS versions are not currently known to be vulnerable to any major malware that spreads exclusively through removable drives, but the possibility of there being one in the future remains. Like most things security related, prevention and education is key. Enforce device policies regarding removable storage, and educate users so that they may know better than to plug unknown or suspicious devices in.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 HID Spoofing\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Devices that resemble standard peripherals may actually contain malicious firmware that simulates user input. The level of sophistication is widely flexible, and it is entirely possible for the device to also function as whatever other device it is pretending to be. The attacker's biggest obstacle is to trick a user into plugging it in, either through social engineering or by tainting the user's/organization's supply chain. Like removable storage malware, policy enforcement and education are the best defenses.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 DMA Attacks\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 During normal operation, macOS assigns specific regions of virtual memory that processes are allowed to access during execution. Attempts to read or write outside of the assigned regions are blocked and result in a fault error. \
In the name of performance and flexibility, some devices are allowed to directly access the computer's physical memory. This is known as Direct Memory Access or DMA. Thunderbolt devices are able to achieve DMA because they are capable of carrying a PCI signal, which by design is able to modify memory regions without operating system interaction. \
DMA attacks have the potential to access any data held in memory, including cryptographic keys and inserting malicious code. DMA attack prevention may be implemented within the operating system, but the only guaranteed method of protection is to physically disable the vulnerable ports. A popular method is epoxy, but this is of course is destructive and may not be an accepted solution.\
\
\
\
\
\
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Understanding System Security Services\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 This section briefly covers some of the services and design choices implemented in macOS to enhance security, and facilitate the configuration of those services. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 GateKeeper\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 GateKeeper acts as the first line of defense against potentially malicious apps by strictly enforcing code signing requirements on them. Apps lacking code signing could be modified to include malicious code, or may actually be a malicious app disguised as a legitimate one. When an unsigned app attempts to run, GateKeeper will block its execution then display a warning dialogue informing the user of the attempt. Apps can be manually approved despite the restrictions from within System Preferences, or by right-clicking the app and then choosing open. \
\
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Enable GateKeeper Using The GUI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 GateKeeper is designed to be as simplistic as possible, and as such only has a handful of settings available to control it. In the Security and Privacy pane of System Preferences, a section is dedicated to adjusting the "level" of restriction GateKeeper enforces. Since macOS Sierra the option to "allow apps from anywhere" has been removed, but it can still be enabled through Terminal. This is not recommended for obvious reasons, but should be known.  \
\
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
Enable GateKeeper Using The CLI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 GateKeeper can be configured using the \'93spctl\'94 command in Terminal. This command exposes options for configuring whitelisting, blacklisting, and app sources that are not available in the GUI.\
We\'92ll start by checking the current status of GateKeeper using spctl with the \'93\'97status option\'94: \
 \
In the above example, GateKeeper is \'93globally\'94 enabled. Any apps that attempt to run that do not have a valid code signature, or apps that are downloaded from the internet will be assessed.\
\
\
\
\
\
GateKeeper operates by maintaining an database of apps that have been accepted or blocked. The spctl command includes options to modify the entries in the database. Database entries are marked with labels to group them for easier management. To whitelist an app, we must first create a label and assign an app it. This is accomplished using spctl with the \'93\'97add\'94 and \'93\'97label\'94 options, followed by the name of the label, and the path to the app: \
\
You should be prompted to enter administrator credentials to change the setting.\
\
\
\
\
\
\
\
Now that the app has been added to the database and assigned a label, we must mark entries with that label as being allowed to execute. Use the spctl command with the \'93\'97enable\'94 and \'93\'97label\'94 options, followed by the label name: \
\
You will again be prompted to provide credentials.\
\
\
\
\
\
\
\
\
Now that the label has been marked for approval, we can just assign apps the label to automatically mark them as approved as well: \
\
\
\
\
\
\
\
\
\
\
Blocking an app follows a similar process, instead using a blacklist. To blacklist an app, first remove any existing labels assigned to it using the \'93\'97disable\'94 option: \
\
Technically this alone would be enough to prevent execution as the app is no longer whitelisted, but a separate blacklist is a better practice to follow. \
\
\
\
\
\
\
\
\
Creating a blacklist is the same as a whitelist, just change the label name to prevent confusion. Here we are using \'93BlockedApps\'94 as the label: \
\
Then disable the entries with the label \'93BlockedApps\'94 to block execution: \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 XProtect\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 XProtect is an anti-malware built into macOS that protects against some of the common threats encountered by Macs. The database of threats detectable by XProtect is rather limited, and isn't updated nearly as often as third-party databases. \
In addition, XProtect uses only string-based signature detection, and does not make use of any heuristic or virtualized execution analysis. This makes it rather crude compared to third-party software, but somewhat reduces the chance of false positives. In any case, do not rely on XProtect as the sole source of malware protection. Many third party products exist that greatly exceed its effectiveness. \
The database used by Xproct is stored as a plist file, and can  be viewed directly using any text editor. In the below example, the \'93Vindinstaller.A\'94 malware definition is shown: \
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 System Integrity Protection\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 In traditional UNIX systems, an all-powerful user known as "root" is present. The root user is intended for use by the operating system or administrator, and can access any part of the system it desires, including other user's personal files. Gaining access to the root account thus gives the attacker complete control, and can enable them to avoid detection.\
Apple felt that the concept of an unlimited root account was no longer needed by default on macOS, and starting with El Capitan the root account is heavily restrained. The root account is no longer allowed to modify or delete protected files in \'93/System\'94, \'93/bin/\'93, \'93/sbin\'94, or \'93/usr\'94, may not modify the memory of system processes or pre-installed apps. The root user is also not allowed to load unsigned Kexts. A full list of restrictions can be read in the \'93/System/Library/Sandbox/rootless.conf\'94 configuration file: \
\
\
\
\
\
These restrictions can be disabled or relaxed using the Terminal within Recovery Mode. To list the current status of SIP, execute "csrutil" with the --status option:  \
\
By default, every protection is enabled. Individual protections can be modified by passing the \'93enable\'94 option followed by the option for the protection(s) to be acted upon. Multiple protections can be modified at once by listing them one after the other. Below is a list of some of the options that can be used, with a short description of protection toggled by that option:\

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrt\brdrnil \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat5 \clwWidth6420\clftsWidth3 \clheight440 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf6 \clbrdrr\brdrnil \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat5 \clwWidth6440\clftsWidth3 \clheight440 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrnil \clbrdrb\brdrs\brdrw20\brdrcf6 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f0\b\fs28 \cf3 \strokec4 Option
\f4\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f0\b\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec4 Protection Toggled
\f4\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf6 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf6 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 \'97without kext
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Kext signing enforcement
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat10 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 \'97without fs
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 File system protection 
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 \'97without debug
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Process debugging protection
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clcbpat10 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 \'97without dtrace
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 Dtrace hooking/injection protection
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell \row

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrl\brdrnil \trbrdrt\brdrnil \trbrdrr\brdrnil 
\clvertalt \clcbpat8 \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf3 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf9 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth6420\clftsWidth3 \clheight360 \clbrdrt\brdrs\brdrw20\brdrcf3 \clbrdrl\brdrs\brdrw20\brdrcf9 \clbrdrb\brdrs\brdrw20\brdrcf3 \clbrdrr\brdrs\brdrw20\brdrcf3 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf7 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec7 \'97without nvram
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 \cell 
\pard\intbl\itap1\pardeftab720\partightenfactor0

\f1\fs28 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 NVRAM modification protection
\f4\fs24 \cf0 \kerning1\expnd0\expndtw0 \up0 \nosupersub \ulnone \outl0\strokewidth0 
\f2\fs32 \cf3 \expnd0\expndtw0\kerning0
\up0 \nosupersub \ulnone \outl0\strokewidth0 \strokec3 \cell \lastrow\row
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0
\cf3 \
\
In the following example, the \'93\'97without debug\'94 option is provided to allow process debugging: \
\
All restrictions can be enabled or disabled at once by providing the "disable" and "enable" options without any of the options detailed in the previous table: \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Kernel Extensions\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Kernel extensions, or Kexts for short, provide a powerful method to extend and build upon the incredibly flexible XNU kernel while minimizing the headaches associated with kernel development. Because Kexts execute code within the kernel and inherit the kernel's privileges, they must be upheld to at utmost level of trust. A single rouge Kext can completely invalidate locally implemented hardening measures. Carefully review all Kexts before use, and if developing software, avoid using Kexts unless absolutely necessary.\
Kexts are stored in the /Library/Extensions directory, with strict permission requirements. Kext files must be owned by the root user and wheel group, with file permission octals set to 0644 (equivalent in hex) and directory octals of 0755 (equivalent in hex). If System Integrity Protection is fully enabled, the Kexts must also be signed by a Kext Developer ID certificate as distributed by Apple. Apple does not give these certificates out freely, and requires justification from the developer for its use before the request is granted.  \
The authenticity of a Kext's signature can be verified using the "codesign" command with the "-d" option. \
\
\
You can also check if any Kexts with invalid signatures are currently loaded using the "kextcache" command with the \'93--system-prelinked-kernel" option: \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Secure Kernel Extension Loading\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 macOS Sierra introduced a security feature that requires user interaction before newly installed Kexts are loaded. When a Kext attempts to load into the kernel, it is automatically blocked and an alert dialogue is shown instructing the user to approve the request within the Security & Privacy pane of System Preferences. This interaction is only available for 30 minutes after the first load request. If the request is not approved, subsequent attempts to load the Kext will not produce an alert. \
This approval process must only be performed once for each Kext, and the kernel will maintain a list of Kexts that have been previously approved based on the Kext's TeamID. It is possible for a device profile to override Secure Kernel Extension Loading, although this is not recommended unless absolutely necessary.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\pard\pardeftab720\sa280\qc\partightenfactor0

\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Mac Firmware\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 As Macs move towards more tightly integrated hardware, the role of the firmware has expanded significantly compared to their PC brethren. Apple\'92s latest Macs actually contain multiple firmwares, each serving a different purpose. \
The primary firmware is the EFI, a customized version of Intel's Extensible Firmware Interface. The EFIn initializing the main and auxiliary x86 CPUs, and executing the code needed to start the operating system. The EFI on Macs is not directly accessible, Apple instead wants users to set NVRAM variables to modify EFI behavior.\
For 2017 and newer Macs, the secondary firmware is located in the T-series SoC (System on Chip). The T-series SoC powers the Touch Bar on appropriately equipped Macs, and on later iterations, even fulfills tasks such as image processing, encryption, storage management, and audio management. As more iterations of the T-series are released, their role in the Mac will likely expand. Perhaps even to the point of replacing the x86 components entirely. Providing such a wide variety of tasks demands more than just a bare bones firmware, and the T-series actually runs a minimal variant of watchOS.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
Firmware Updates\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Firmware updates were previously delivered as independent packages, but starting in 2015 firmware updates are now bundled with standard macOS updates. You may still download the firmware updates separately however. One would think the simplest means of getting the most recent firmware would thus be to apply the latest macOS update, but in many cases this isn't exactly true. For uncertain reasons, firmware updates often fail without warning, and some models scarcely receive firmware updates at all. \
Apple doesn't provide an official list of the most recent firmwares for each model, and after High Sierra the update packages don't list which firmware images they contain. To compound the issue even further, System Information and the "eficheck" tool use different numbering schemes to denote the installed EFI version. Some firmwares share the same version number in System Information, but different numbers according to eficheck. Apple seems to have given up on the situation, and chosen instead to focus on implementing firmware verification within the T-series SoC.\
\
The T-series SoC moves firmware verification from the OS to hardware, establishing authenticity based on a cryptographic key burned into the silicon. During the initialization of the T-series SoC, the SoC's kernel cache is verified, which is then used to  verify the x86 EFI. Although T-series relieves some of the burden of maintaining firmware security, you must still ensure that firmware updates are being applied.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Firmware Passwords\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Restricting access to the firmware is just as important as securing the OS that runs atop it. With unrestricted access to the firmware settings, anyone with a physical presence could change boot disks, reset passwords, or even modify installed operating systems. While FileVault2 negates the later two risks, a user could still use the unrestricted firmware access to boot from an insecure external media. Firmware passwords can be applied using a device policy, or manually set using the Firmware Utility in Recovery Mode: \
\
Additional services and design choices are implemented to secure macOS, but the most important ones have now been covered directly. More will be discussed in context in the rest of the chapter.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 System Updates\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 System updates on macOS have traditionally been delivered through a major and minor versioning scheme similar to most software. Major versions signify significant changes and potential compatibility breaks, while minor or "point" versions are incremental updates to add features or address bugs.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Update Frequency and Support Life Cycles\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 While Apple does not maintain any sort of official update schedule, they tend to follow rough patterns. Major versions are released yearly, while minor versions are released on average every 60 days. Keep in mind that this is just an average, and the actual frequency between updates may fluctuate dramatically. \
Estimating the support life cycle of macOS versions is also quite a challenge. Apple does not publish official end-of-life statements in any useful advance, nor do they consistently back port security and feature updates to older versions. You can generally expect Apple to provide updates for each major version for about 40 months, with the minor point versions inheriting a support cycle similar to their parent major versions.\
\
\
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Applying System Updates Using The GUI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The reasons why you apply system updates are obvious enough, but the ways to do so may not be. macOS provides both graphical and command line methods of update management, depending on the version.\
High Sierra was the last operating system version that used the App Store for both system and app updates. Under the Updates section, available updates are listed first, with previously installed updates listed beneath them. Details for each update are available, and longer change notes can be expanded by clicking on the "More" text link.  \
\
\
\
\
In the earliest versions of macOS, system updates were delivered through the System Updates pane within System Preferences. This was shortly thereafter moved to the App Store, but with Mojave it has made its return: \
\
The App Store is still used to deliver app updates in Mojave, with the exception of pre-installed apps like Safari or Calendar. These are bundled with operating system updates. \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
Applying System Updates Using The CLI\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Update management is also available from the command line using the "softwareupdate" command. The primary benefits over the graphical tools are scriptability and accessibility through a SSH session. Widespread anecdotal evidence also exists stating that the command line update tool is faster than the graphical one.\
To see a list of available updates use the "-l" option: \
\
Updates are labeled with the version, size, and recommendation status. Note that simply listing available updates does not require the use of "sudo" to elevate privileges, but options that potentially modify the system using the command will. \
\
\
\
\
\
To install only the recommended updates, use the  "-ir" options: \
\
Specific updates can be installed using the "-i" option and the name of the update package:  \
If you need to blacklist an update, use the "--ignore" flag. \
\
Like most command line utilities, you can view other available commands using the "-h" option.\
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
Combating Malware\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 There is a common misconception within the Mac community that Macs are either immune, or at least so highly resistant to malware, that they do not require the use of anti-malware security software. So prevalent is this mindset, that at the time of publication, nearly 80% of consumer Macs are not running anti-malware software. \
As a security minded individual, it would be ludicrous to fall into this mindset. Even if a particular Mac on the network does not perform activities that would place it at risk, it could still be used as a beachhead for attack on more lucrative targets. Secure every machine, including single purpose and kiosk devices.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Active Anti-Malware\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 When choosing an anti-malware software be sure to research your options thoroughly, and be especially sure to choose an anti-malware that provides active protection.\
Active anti-malware scans new and modified files in real time on the system, to ensure they aren\'92t the product or victims of malicious activity. In contrast, passive anti-malware only acts when a scan is scheduled or initiated by the user. While passive anti-malware can certainly be effective in its detection scans, it is not able to protect from attacks as they happen. Detecting and removing malware after the fact is of course better than nothing at all, but the best approach is to prevent the infection as it happens. \
The anti-malware ecosystem is fortunately very diverse, and several competing products of varying utility are available for the Mac platform. Some of these are full suites that are contained within the device, while others are endpoint protection - suitable for central management in organizations.\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 End-Point Protection\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 An endpoint is any device that can connect to a network you secure. Endpoint security is different from standalone software in that it places a focus on providing centralized control. The central control server(s) can push custom policies and updates, retrieve information from endpoints, and automate management tasks. Endpoint anti-malware can be utilized effectively in smaller networks, but the effort and expertise required to implement and maintain them may be excessive. \
Endpoint suites are commonly sold through distributors who negotiate sales on behalf of the software author. These distributors will work with your organization to determine the best solution they offer. It may be harder for smaller organizations to attract the interest of distributors, but many specifically service the needs of smaller clients.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Standalone Protection\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 In comparison to endpoint-based protection, standalone protection is independent of other machines on the network, and does not facilitate centralized management. Standalone protection is common among home and small business users, and provides much of the same protections offered by endpoint suites. Choosing a standalone protection is largely personal, but some vendors are more effective than others. You are encouraged to do your own research to determine the best vendor for your needs.\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Vulnerability Awareness\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Maintaining awareness of the vulnerabilities that could potentially affect you will allow you to take a proactive approach in your defense against them. If you notice a particular kind of vulnerability is becoming a trend in the industry, your awareness just provided warning as to what might affect you in the future.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Keeping up with Vulnerabilities\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Product vendors usually maintain online public bulletins and mailing lists to track recognized vulnerabilities. Apple fortunately follows suite, providing a security-announce mailing list, and several support articles listing security updates and their contents. Exact URLs are not listed here due to their non-permanence, but a simple search will get you to them.\
If a vendor of the software or hardware you use does not make sufficient effort to provide some sort of vulnerability tracker, it is suggested to replace them with one who does as soon as possible. Knowledge is power, and in the security world, what you don't know is what will hurt you. \
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\
\
\
Chapter Five: Securing User Facing  Apps and Software\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 A secure base system may provide a reliable means with which to support the apps above it, but if the app themselves are vulnerable they expose the whole system to attack. This chapter will focus on the mechanisms used to secure apps, and methods that can be applied to increase the security of certain default apps. \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
App Code Security\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Some of the methods used to validate and secure apps have been briefly covered already in previous chapters. Such content will be re-iterated here in greater depth, while new concepts will be covered more broadly.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 App Signing\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Apple requires every app submitted to the App Store to have a valid digital signature on all the files in the app\'92s bundle. This signature is derived from a developer account registered with Apple.\
Apple has recently amended its policies regarding apps from outside the App Store. Developers may now \'93notarize\'94 apps by submitting them to Apple\'92s automatic review process, and in return receive a signed app. App notarization allows developers freedom from some of the App Store\'92s restrictions, while still providing Apple with the ability to govern over the Mac\'92s app ecosystem. Some developers express concern that this is a hint that Apple may be working towards a future where unsigned apps are not allowed to run at all (like iOS).\
To take advantage of the protections offered by app signing, the apps you use or deploy to your organization\'92s devices must be signed by the app\'92s developer or by your developer certificate.\
You can do this using Xcode or the command line utility \'93codesign\'94.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Signing Apps Graphically\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Apps can be signed graphically using Xcode, an IDE developed by Apple to support software development for all of its products. Before you can begin signing apps with it, you must download Xcode from the App Store and accept the Xcode terms and conditions. Once this is done, open the project in Xcode that contains the app you wish to sign: \
\
By default, Xcode applies signatures to apps when they are exported for distribution. No explicit interaction is required beyond ensuring you that are using the right developer identity during export. There may still arise a situation however, where you would like to change the default settings applied to the signing stage during app export.\
\
\
\
\
To locate the relevant settings, click on the name of the app under the \'93Project\'94 setting in the left sidebar. Navigate to the \'93Build Settings\'94 tab and scroll down to the section titled \'93Other Code Signing Flags\'94:  \
The flags added here will be directly passed to the \'93codesign\'94 command, which is executed during the export process.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
\
\
\
\
\
\
\
\
Signing Apps Using The Command Line \
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 To sign an app using the \'93codesign\'94 command, first download your Developer ID certificate and add it using the Keychain Access utility: \
\
\
\
\
\
\
\
\
\
\
Now that the certificate is in the keychain, you are ready to sign an app. Open a Terminal and navigate to the directory containing the app bundle. Invoke the codesign command using the \'93\'97deep\'94, \'93\'97force\'94, and \'93\'97sign\'94 options, followed by the developer identity in quotes, and the name of the app bundle: \
\
\
\
\
\
\
\
\
\
If you are unsure of your developer identity, it can be found using the \'93security\'94 command with the \'93find-identity\'94, \'93-v\'94, \'93-p\'94, and \'93codesigning\'94 options. The only security identities that will be displayed are those capable of signing software:  \
\pard\pardeftab720\partightenfactor0

\f5\fs26 \cf12 \cb13 \strokec12  \
\
\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\fs32 \cf3 \cb1 \strokec3 You may notice that the first identity listed is followed by a message indicating the identity certificate is expired. Keep in mind that this command will show all identities that meet the code signing criteria, even if they are no longer valid.\
If your app consists of a bare binary, you cannot sign it, but you can add an exception for it in GateKeeper using the \'93spctl\'94 command, or through an MDM profile. \
\pard\pardeftab720\partightenfactor0

\f6\fs22 \cf3 \strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
\
\
\
Securing Default Apps\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Apps like Safari and Mail may only make up a minuscule portion of macOS if you are counting lines of code, but they are used to consume the largest amount of outside content. Apple has done a relatively good job of hardening them against attack, but additional means are available to secure them even further.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Safari\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Safari is the default web browser used in all of Apple\'92s internet enabled products. First released with Mac OS X Panther, Safari\'92s WebKit engine has become the basis for the majority of browsers currently in use.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3  Content Blocking\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Content blocking rules modify the way Safari handles web content. Rules can hide elements, strip cookies, and and block elements from being loaded.  By blocking unwanted content SafariContent Blockers are different from Extensions in that they are not based on executable code, rather they use an array of JSON objects that are compiled into byte code.  A blank Content Blocker template is bundled with Xcode, should you need to make your own.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3  Ad Blocking Malicious Ads\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Ad blockers can act as a protection against malware by preventing ads embedded with malicious code from been loaded by the web browser. The intention of the code can range from battery-draining crypto-mining scripts, to exploit code designed to give hijackers control of the device. The structure of the online advertising industry inadvertently enables attackers to increase the accuracy of their malware campaigns by allowing them to use interest based advertising tracking as a means to target specific groups.\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3  Tracking and Fingerprinting Protection\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Browser fingerprinting allows websites and advertisers to track users across the web by recording data points about the web browser used to visit the website. The more data points that are collected, the easier is it to track the browser\'92s movements. Data points consist of information like available fonts, extensions, time zones, content blockers, and even things like screen resolution and the number of CPU cores.\
Safari attempts to combat tracking and fingerprinting be limiting the information it exposes to websites to the bare minimum needed to function. The data points described above are generalized as much as possible, and detected attempts to track using cookies are blocked. There is no real configuration needed to take advantage of tracking protection,  but it is not a silver bullet. Some techniques, such as tracking pixels or third-party scripts may still be successful.\
 \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Extensions\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 With macOS Mojave, Apple introduced a new \'93App Extension\'94 architecture for Safari extensions. Apple claims its an effort to increase efficiency and security, but malicious extensions still proliferate at an ever increasing rate. \
In most cases the extensions take on the form of adware or spyware, installed by malicious apps on the Mac. Even extensions made with purely good intent can provide a beachhead for attackers due to the security vulnerabilities present in the extension\'92s code. A 2017 study by usenix found that upwards of 40% of the extensions in the Apple-curated Safari gallery were vulnerable. \
While extensions can be a useful tool to extend functionality, rampant abuse and poor design has made the restriction of extensions a necessity. Apple has began adding malicious extension signatures to XProtect, and you can block the installation of extensions by blocking the installation of apps from the App Store.\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Plugins\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Web plugins such as Java can introduce extreme security vulnerabilities into Safari, as they allow the execution of code to take place outside of the sandboxed browser engine. Modern Safari versions attempt to mitigate this by blocking potentially insecure plugins by default, but an even better solution is to not have the plugins installed at all. It is recommended that this block not be overridden unless users need access to content requiring their use.\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3  URL Display\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 By default, Safari only shows the domain name of the current website in the address bar.  The full address can still be viewed by clicking on the domain name, but some users will be more comfortable being able to see it at all times. A setting is available in Safari\'92s preferences to toggle between the full URL and the domain name: \
\
\
 \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Autofill\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 With Autofill, Safari can automatically fill in text entry fields on the web. Everything from credit numbers to addresses is covered by Autofill, and it can pull new data from existing personal data like contacts. Autofill can greatly speed up repetitive tasks, but on shared devices or extremely sensitive information it presents as extreme risk for data loss. The Autofill tab in Safari preferences lists a series of check boxes to enable or disable specific Autofill functionality: \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3  \
Cookies\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 Nearly every useful website on the internet uses cookies in some fashion to enhance usability and provide critical functionality to its users. This can range from storing user website preferences to remembering login data across pages. Cookies are a necessary part of the modern web, but they can become a problem when they are used to track and profile users.  By default Safari limits this behavior via Intelligent Tracking Protection, which detects and blocks 3rd-party tracking cookies. You may choose to implement custom policies regarding cookies, but be careful not to inadvertently impact the functionality of websites in the process.\
\
\
\
\
Cookies and related settings can be managed from the Privacy tab in Safari\'92s preferences: \
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
Do Not Track \
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 When Safari requests content over HTTP, it can include a extra header called  Do Not Track (DNT), which asks the server to not track the user. Safari has no control over whether the request is honored, and it is often ignored regardless. The authors recommend against enabling DNT, as it could be used as an additional metric to fingerprint and track users. The setting to toggle DNT can be found under the Privacy tab in Safari preferences as just shown previously.\
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 Apple Mail\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 While Mail may not be the feature full mail client, it boasts unmatched integration and consistency across platforms. The security issues you may encounter during the use of the Mail app are less the fault of Mail, and more the fault of the aging and insecure mail protocols still in use. Not much can be done about the protocols themselves, but the application of encryption and some common sense can go a long way to bringing email up to speed.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
GPG/PGP Encryption\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 PGP is an acronym for \'93Pretty Good Privacy\'94, the name of a encryption program created by Phil Zimmerman in in early 1990s to secure and authenticate data communications. GPG (GNU Privacy Guard) is a modern implementation of the now-standardized PGP specification. \
PGP encryption is based on a concept known as \'93public key cryptography\'94,  in which publicly available keys can be used to encrypt data so that it can only be decrypted by the person with the private key. The private key can also be used sign data, allowing others to use the public key to verify that it was transmitted by the person with the corresponding private key. PGP stands out among competing ciphers because it is not only publicly verified, but mathematically proven. Unless significant advancements are made in the field of prime factorization, PGP is mathematically proven to be secure against a given attack.\
You can apply PGP signing and encryption to email using either a command line utility, or one of the many Mail plugins and graphical tools available. \
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\pard\pardeftab720\sa500\partightenfactor0

\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 S/MIME\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 S/MIME is a protocol standard implementing public key encryption and signing of MIME (email) data. The infrastructure used to achieve security is similar to that of PGP, and suffers from many of the same caveats. S/MIME enables sender verification, but requires the sender\'92s signing certificate to be registered with a recognized certificate authority (CA). An in-house certificates authority can be viable for use within a organization, but cannot effectively extend beyond the scope of that organization to third parties. \
In early 2018, the Electronic Frontier Foundation announced the discovery of of several critical vulnerabilities within many S/MIME implementations used in email clients. The disclosed vulnerabilities compromised the data encryption, allowing plaintext exfiltration of the email\'92s contents.  \
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 Attachments\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 The biggest risks associated with email attachments are typically malware distribution and data loss. The latter can be handled by use policies and data loss prevention (DLP) appliances, but the former is significantly more difficult because security measures like encryption can actively work against you in this situation. If emails or attachments are encrypted end-to-end, it will be impossible to perform malware scans the contents during transmission. Escrow keys provide a solution to this issue, but create a central point of failure that could allow mass data exfiltration.\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs26 \cf3 \kerning1\expnd10\expndtw52
\strokec3 \
\
\
\
\
\
\
\
\
\
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
Chapter Six: Putting It All Together \
\
\pard\pardeftab720\sl264\slmult1\sa320\qc\partightenfactor0

\f3\i\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 "The great moral question of the twenty-first century is this: if all knowledge, all culture, all art, all useful information can be costlessly given to everyone at the same price that it is given to anyone; if everyone can have everything, anywhere, all the time, why is it ever moral to exclude anyone?
\fs35\fsmilli17600 \cf3 \strokec3 "\
\pard\pardeftab720\sl264\slmult1\sa320\qc\partightenfactor0

\f2\i0 \cf3 \strokec3 - 
\fs32 \cf3 \strokec3 Eben Moglen\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 \
Now that you\'92ve reached the end of this kickstart guide, you may be wondering \'93where do I go from here?\'94. The truth is that knowledge - like most things, is best coupled with experience. Experiment with what you have learned, and don\'92t be afraid to break things. In the (likely) event you do make a mess, fixing it serves as a valuable lesson unto itself. \
Remember your ethics, and let them guide you along your path as you leap upon opportunity. \
I encourage all readers to share and adapt this work, under the terms of the Creative Commons license this publication is licensed under. More detailed information can be found about this license in the proceeding page:\
\
\
\
\
\pard\pardeftab720\sa500\partightenfactor0

\f0\b\fs34 \cf3 \kerning1\expnd13\expndtw68
\strokec3 \
License Information For This Publication\
\pard\pardeftab720\sl264\slmult1\sa320\partightenfactor0

\f2\b0\fs32 \cf3 \expnd0\expndtw0\kerning0
\strokec3 This publication is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. A copy of the license is included below:\
\
\pard\pardeftab720\partightenfactor0

\f7\fs26 \cf3 \strokec3 Attribution-NonCommercial-ShareAlike 4.0 International\
\
=======================================================================\
\
Creative Commons Corporation ("Creative Commons") is not a law firm and\
does not provide legal services or legal advice. Distribution of\
Creative Commons public licenses does not create a lawyer-client or\
other relationship. Creative Commons makes its licenses and related\
information available on an "as-is" basis. Creative Commons gives no\
warranties regarding its licenses, any material licensed under their\
terms and conditions, or any related information. Creative Commons\
disclaims all liability for damages resulting from their use to the\
fullest extent possible.\
\
Using Creative Commons Public Licenses\
\
Creative Commons public licenses provide a standard set of terms and\
conditions that creators and other rights holders may use to share\
original works of authorship and other material subject to copyright\
and certain other rights specified in the public license below. The\
following considerations are for informational purposes only, are not\
exhaustive, and do not form part of our licenses.\
\
     Considerations for licensors: Our public licenses are\
     intended for use by those authorized to give the public\
     permission to use material in ways otherwise restricted by\
     copyright and certain other rights. Our licenses are\
     irrevocable. Licensors should read and understand the terms\
     and conditions of the license they choose before applying it.\
     Licensors should also secure all rights necessary before\
     applying our licenses so that the public can reuse the\
     material as expected. Licensors should clearly mark any\
     material not subject to the license. This includes other CC-\
     licensed material, or material used under an exception or\
     limitation to copyright. More considerations for licensors:\
	wiki.creativecommons.org/Considerations_for_licensors\
\
\
\
\
\
\
\
\
\
\
\
     Considerations for the public: By using one of our public\
     licenses, a licensor grants the public permission to use the\
     licensed material under specified terms and conditions. If\
     the licensor's permission is not necessary for any reason--for\
     example, because of any applicable exception or limitation to\
     copyright--then that use is not regulated by the license. Our\
     licenses grant only permissions under copyright and certain\
     other rights that a licensor has authority to grant. Use of\
     the licensed material may still be restricted for other\
     reasons, including because others have copyright or other\
     rights in the material. A licensor may make special requests,\
     such as asking that all changes be marked or described.\
     Although not required by our licenses, you are encouraged to\
     respect those requests where reasonable. More considerations\
     for the public: \
	wiki.creativecommons.org/Considerations_for_licensees\
\
=======================================================================\
\
Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International\
Public License\
\
By exercising the Licensed Rights (defined below), You accept and agree\
to be bound by the terms and conditions of this Creative Commons\
Attribution-NonCommercial-ShareAlike 4.0 International Public License\
("Public License"). To the extent this Public License may be\
interpreted as a contract, You are granted the Licensed Rights in\
consideration of Your acceptance of these terms and conditions, and the\
Licensor grants You such rights in consideration of benefits the\
Licensor receives from making the Licensed Material available under\
these terms and conditions.\
\
\
Section 1 -- Definitions.\
\
  a. Adapted Material means material subject to Copyright and Similar\
     Rights that is derived from or based upon the Licensed Material\
     and in which the Licensed Material is translated, altered,\
     arranged, transformed, or otherwise modified in a manner requiring\
     permission under the Copyright and Similar Rights held by the\
     Licensor. For purposes of this Public License, where the Licensed\
     Material is a musical work, performance, or sound recording,\
     Adapted Material is always produced where the Licensed Material is\
     synched in timed relation with a moving image.\
\
  b. Adapter's License means the license You apply to Your Copyright\
     and Similar Rights in Your contributions to Adapted Material in\
     accordance with the terms and conditions of this Public License.\
\
  c. BY-NC-SA Compatible License means a license listed at\
     creativecommons.org/compatiblelicenses, approved by Creative\
     Commons as essentially the equivalent of this Public License.\
\
  \
\
\
\
d. Copyright and Similar Rights means copyright and/or similar rights\
     closely related to copyright including, without limitation,\
     performance, broadcast, sound recording, and Sui Generis Database\
     Rights, without regard to how the rights are labeled or\
     categorized. For purposes of this Public License, the rights\
     specified in Section 2(b)(1)-(2) are not Copyright and Similar\
     Rights.\
\
  e. Effective Technological Measures means those measures that, in the\
     absence of proper authority, may not be circumvented under laws\
     fulfilling obligations under Article 11 of the WIPO Copyright\
     Treaty adopted on December 20, 1996, and/or similar international\
     agreements.\
\
  f. Exceptions and Limitations means fair use, fair dealing, and/or\
     any other exception or limitation to Copyright and Similar Rights\
     that applies to Your use of the Licensed Material.\
\
  g. License Elements means the license attributes listed in the name\
     of a Creative Commons Public License. The License Elements of this\
     Public License are Attribution, NonCommercial, and ShareAlike.\
\
  h. Licensed Material means the artistic or literary work, database,\
     or other material to which the Licensor applied this Public\
     License.\
\
  i. Licensed Rights means the rights granted to You subject to the\
     terms and conditions of this Public License, which are limited to\
     all Copyright and Similar Rights that apply to Your use of the\
     Licensed Material and that the Licensor has authority to license.\
\
  j. Licensor means the individual(s) or entity(ies) granting rights\
     under this Public License.\
\
  k. NonCommercial means not primarily intended for or directed towards\
     commercial advantage or monetary compensation. For purposes of\
     this Public License, the exchange of the Licensed Material for\
     other material subject to Copyright and Similar Rights by digital\
     file-sharing or similar means is NonCommercial provided there is\
     no payment of monetary compensation in connection with the\
     exchange.\
\
  l. Share means to provide material to the public by any means or\
     process that requires permission under the Licensed Rights, such\
     as reproduction, public display, public performance, distribution,\
     dissemination, communication, or importation, and to make material\
     available to the public including in ways that members of the\
     public may access the material from a place and at a time\
     individually chosen by them.\
\
  m. Sui Generis Database Rights means rights other than copyright\
     resulting from Directive 96/9/EC of the European Parliament and of\
     the Council of 11 March 1996 on the legal protection of databases,\
     as amended and/or succeeded, as well as other essentially\
     equivalent rights anywhere in the world.\
\
\
  n. You means the individual or entity exercising the Licensed Rights\
     under this Public License. Your has a corresponding meaning.\
\
\
Section 2 -- Scope.\
\
  a. License grant.\
\
       1. Subject to the terms and conditions of this Public License,\
          the Licensor hereby grants You a worldwide, royalty-free,\
          non-sublicensable, non-exclusive, irrevocable license to\
          exercise the Licensed Rights in the Licensed Material to:\
\
            a. reproduce and Share the Licensed Material, in whole or\
               in part, for NonCommercial purposes only; and\
\
            b. produce, reproduce, and Share Adapted Material for\
               NonCommercial purposes only.\
\
       2. Exceptions and Limitations. For the avoidance of doubt, where\
          Exceptions and Limitations apply to Your use, this Public\
          License does not apply, and You do not need to comply with\
          its terms and conditions.\
\
       3. Term. The term of this Public License is specified in Section\
          6(a).\
\
       4. Media and formats; technical modifications allowed. The\
          Licensor authorizes You to exercise the Licensed Rights in\
          all media and formats whether now known or hereafter created,\
          and to make technical modifications necessary to do so. The\
          Licensor waives and/or agrees not to assert any right or\
          authority to forbid You from making technical modifications\
          necessary to exercise the Licensed Rights, including\
          technical modifications necessary to circumvent Effective\
          Technological Measures. For purposes of this Public License,\
          simply making modifications authorized by this Section 2(a)\
          (4) never produces Adapted Material.\
\
       5. Downstream recipients.\
\
            a. Offer from the Licensor -- Licensed Material. Every\
               recipient of the Licensed Material automatically\
               receives an offer from the Licensor to exercise the\
               Licensed Rights under the terms and conditions of this\
               Public License.\
\
            b. Additional offer from the Licensor -- Adapted Material.\
               Every recipient of Adapted Material from You\
               automatically receives an offer from the Licensor to\
               exercise the Licensed Rights in the Adapted Material\
               under the conditions of the Adapter's License You apply.\
\
\
\
\
\
            c. No downstream restrictions. You may not offer or impose\
               any additional or different terms or conditions on, or\
               apply any Effective Technological Measures to, the\
               Licensed Material if doing so restricts exercise of the\
               Licensed Rights by any recipient of the Licensed\
               Material.\
\
       6. No endorsement. Nothing in this Public License constitutes or\
          may be construed as permission to assert or imply that You\
          are, or that Your use of the Licensed Material is, connected\
          with, or sponsored, endorsed, or granted official status by,\
          the Licensor or others designated to receive attribution as\
          provided in Section 3(a)(1)(A)(i).\
\
  b. Other rights.\
\
       1. Moral rights, such as the right of integrity, are not\
          licensed under this Public License, nor are publicity,\
          privacy, and/or other similar personality rights; however, to\
          the extent possible, the Licensor waives and/or agrees not to\
          assert any such rights held by the Licensor to the limited\
          extent necessary to allow You to exercise the Licensed\
          Rights, but not otherwise.\
\
       2. Patent and trademark rights are not licensed under this\
          Public License.\
\
       3. To the extent possible, the Licensor waives any right to\
          collect royalties from You for the exercise of the Licensed\
          Rights, whether directly or through a collecting society\
          under any voluntary or waivable statutory or compulsory\
          licensing scheme. In all other cases the Licensor expressly\
          reserves any right to collect such royalties, including when\
          the Licensed Material is used other than for NonCommercial\
          purposes.\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
Section 3 -- License Conditions.\
\
Your exercise of the Licensed Rights is expressly made subject to the\
following conditions.\
\
  a. Attribution.\
\
       1. If You Share the Licensed Material (including in modified\
          form), You must:\
\
            a. retain the following if it is supplied by the Licensor\
               with the Licensed Material:\
\
                 i. identification of the creator(s) of the Licensed\
                    Material and any others designated to receive\
                    attribution, in any reasonable manner requested by\
                    the Licensor (including by pseudonym if\
                    designated);\
\
                ii. a copyright notice;\
\
               iii. a notice that refers to this Public License;\
\
                iv. a notice that refers to the disclaimer of\
                    warranties;\
\
                 v. a URI or hyperlink to the Licensed Material to the\
                    extent reasonably practicable;\
\
            b. indicate if You modified the Licensed Material and\
               retain an indication of any previous modifications; and\
\
            c. indicate the Licensed Material is licensed under this\
               Public License, and include the text of, or the URI or\
               hyperlink to, this Public License.\
\
       2. You may satisfy the conditions in Section 3(a)(1) in any\
          reasonable manner based on the medium, means, and context in\
          which You Share the Licensed Material. For example, it may be\
          reasonable to satisfy the conditions by providing a URI or\
          hyperlink to a resource that includes the required\
          information.\
       3. If requested by the Licensor, You must remove any of the\
          information required by Section 3(a)(1)(A) to the extent\
          reasonably practicable.\
\
  b. ShareAlike.\
\
     In addition to the conditions in Section 3(a), if You Share\
     Adapted Material You produce, the following conditions also apply.\
\
       1. The Adapter's License You apply must be a Creative Commons\
          license with the same License Elements, this version or\
          later, or a BY-NC-SA Compatible License.\
\
\
\
       2. You must include the text of, or the URI or hyperlink to, the\
          Adapter's License You apply. You may satisfy this condition\
          in any reasonable manner based on the medium, means, and\
          context in which You Share Adapted Material.\
\
       3. You may not offer or impose any additional or different terms\
          or conditions on, or apply any Effective Technological\
          Measures to, Adapted Material that restrict exercise of the\
          rights granted under the Adapter's License You apply.\
\
\
Section 4 -- Sui Generis Database Rights.\
\
Where the Licensed Rights include Sui Generis Database Rights that\
apply to Your use of the Licensed Material:\
\
  a. for the avoidance of doubt, Section 2(a)(1) grants You the right\
     to extract, reuse, reproduce, and Share all or a substantial\
     portion of the contents of the database for NonCommercial purposes\
     only;\
\
  b. if You include all or a substantial portion of the database\
     contents in a database in which You have Sui Generis Database\
     Rights, then the database in which You have Sui Generis Database\
     Rights (but not its individual contents) is Adapted Material,\
     including for purposes of Section 3(b); and\
\
  c. You must comply with the conditions in Section 3(a) if You Share\
     all or a substantial portion of the contents of the database.\
\
For the avoidance of doubt, this Section 4 supplements and does not\
replace Your obligations under this Public License where the Licensed\
Rights include other Copyright and Similar Rights.\
\
\
Section 5 -- Disclaimer of Warranties and Limitation of Liability.\
\
  a. UNLESS OTHERWISE SEPARATELY UNDERTAKEN BY THE LICENSOR, TO THE\
     EXTENT POSSIBLE, THE LICENSOR OFFERS THE LICENSED MATERIAL AS-IS\
     AND AS-AVAILABLE, AND MAKES NO REPRESENTATIONS OR WARRANTIES OF\
     ANY KIND CONCERNING THE LICENSED MATERIAL, WHETHER EXPRESS,\
     IMPLIED, STATUTORY, OR OTHER. THIS INCLUDES, WITHOUT LIMITATION,\
     WARRANTIES OF TITLE, MERCHANTABILITY, FITNESS FOR A PARTICULAR\
     PURPOSE, NON-INFRINGEMENT, ABSENCE OF LATENT OR OTHER DEFECTS,\
     ACCURACY, OR THE PRESENCE OR ABSENCE OF ERRORS, WHETHER OR NOT\
     KNOWN OR DISCOVERABLE. WHERE DISCLAIMERS OF WARRANTIES ARE NOT\
     ALLOWED IN FULL OR IN PART, THIS DISCLAIMER MAY NOT APPLY TO YOU.\
\
  b. TO THE EXTENT POSSIBLE, IN NO EVENT WILL THE LICENSOR BE LIABLE\
     TO YOU ON ANY LEGAL THEORY (INCLUDING, WITHOUT LIMITATION,\
     NEGLIGENCE) OR OTHERWISE FOR ANY DIRECT, SPECIAL, INDIRECT,\
     INCIDENTAL, CONSEQUENTIAL, PUNITIVE, EXEMPLARY, OR OTHER LOSSES,\
     COSTS, EXPENSES, OR DAMAGES ARISING OUT OF THIS PUBLIC LICENSE OR\
     USE OF THE LICENSED MATERIAL, EVEN IF THE LICENSOR HAS BEEN\
     ADVISED OF THE POSSIBILITY OF SUCH LOSSES, COSTS, EXPENSES, OR\
     DAMAGES. WHERE A LIMITATION OF LIABILITY IS NOT ALLOWED IN FULL OR\
     IN PART, THIS LIMITATION MAY NOT APPLY TO YOU.\
\
  c. The disclaimer of warranties and limitation of liability provided\
     above shall be interpreted in a manner that, to the extent\
     possible, most closely approximates an absolute disclaimer and\
     waiver of all liability.\
\
\
Section 6 -- Term and Termination.\
\
  a. This Public License applies for the term of the Copyright and\
     Similar Rights licensed here. However, if You fail to comply with\
     this Public License, then Your rights under this Public License\
     terminate automatically.\
\
  b. Where Your right to use the Licensed Material has terminated under\
     Section 6(a), it reinstates:\
\
       1. automatically as of the date the violation is cured, provided\
          it is cured within 30 days of Your discovery of the\
          violation; or\
\
       2. upon express reinstatement by the Licensor.\
\
     For the avoidance of doubt, this Section 6(b) does not affect any\
     right the Licensor may have to seek remedies for Your violations\
     of this Public License.\
\
  c. For the avoidance of doubt, the Licensor may also offer the\
     Licensed Material under separate terms or conditions or stop\
     distributing the Licensed Material at any time; however, doing so\
     will not terminate this Public License.\
\
  d. Sections 1, 5, 6, 7, and 8 survive termination of this Public\
     License.\
\
\
Section 7 -- Other Terms and Conditions.\
\
  a. The Licensor shall not be bound by any additional or different\
     terms or conditions communicated by You unless expressly agreed.\
\
  b. Any arrangements, understandings, or agreements regarding the\
     Licensed Material not stated herein are separate from and\
     independent of the terms and conditions of this Public License.\
\
\
Section 8 -- Interpretation.\
\
  a. For the avoidance of doubt, this Public License does not, and\
     shall not be interpreted to, reduce, limit, restrict, or impose\
     conditions on any use of the Licensed Material that could lawfully\
     be made without permission under this Public License.\
\
\
\
\
\
  b. To the extent possible, if any provision of this Public License is\
     deemed unenforceable, it shall be automatically reformed to the\
     minimum extent necessary to make it enforceable. If the provision\
     cannot be reformed, it shall be severed from this Public License\
     without affecting the enforceability of the remaining terms and\
     conditions.\
\
  c. No term or condition of this Public License will be waived and no\
     failure to comply consented to unless expressly agreed to by the\
     Licensor.\
\
  d. Nothing in this Public License constitutes or may be interpreted\
     as a limitation upon, or waiver of, any privileges and immunities\
     that apply to the Licensor or You, including from the legal\
     processes of any jurisdiction or authority.\
\
=======================================================================\
\
Creative Commons is not a party to its public\
licenses. Notwithstanding, Creative Commons may elect to apply one of\
its public licenses to material it publishes and in those instances\
will be considered the \'93Licensor.\'94 The text of the Creative Commons\
public licenses is dedicated to the public domain under the CC0 Public\
Domain Dedication. Except for the limited purpose of indicating that\
material is shared under a Creative Commons public license or as\
otherwise permitted by the Creative Commons policies published at\
creativecommons.org/policies, Creative Commons does not authorize the\
use of the trademark "Creative Commons" or any other trademark or logo\
of Creative Commons without its prior written consent including,\
without limitation, in connection with any unauthorized modifications\
to any of its public licenses or any other arrangements,\
understandings, or agreements concerning use of licensed material. For\
the avoidance of doubt, this paragraph does not form part of the\
public licenses.\
\
Creative Commons may be contacted at creativecommons.org.\
\
\pard\pardeftab720\sa280\qc\partightenfactor0

\f0\b\fs52 \cf3 \kerning1\expnd20\expndtw104
\strokec3 \
\
}